!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Cd){"use strict";try{(function(){Cd=Cd&&Object.prototype.hasOwnProperty.call(Cd,"default")?Cd.default:Cd;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),c=(Object.defineProperty(h.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),h.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(h.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),h.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},h.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},h.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},h.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},h.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},h);function h(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,y=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new y(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g;function E(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},_=N||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function x(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),P=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function R(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:R).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var U=Date.now||function(){return+new Date};function M(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,O)&&t[O]||(t[O]=++P);var t},j.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var W,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var X=_.navigator;if(X){var Q=X.userAgent;if(Q){W=Q;break t}}W=""}function Y(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=H(W,"Opera"),ot=H(W,"Trident")||H(W,"MSIE"),st=H(W,"Edge"),ut=st||ot,at=H(W,"Gecko")&&!(H(W.toLowerCase(),"webkit")&&!H(W,"Edge"))&&!(H(W,"Trident")||H(W,"MSIE"))&&!H(W,"Edge"),ct=H(W.toLowerCase(),"webkit")&&!H(W,"Edge");function ht(){var t=_.document;return t?t.documentMode:void 0}t:{var ft="",lt=(rt=W,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){var pt=ht();if(null!=pt&&pt>parseFloat(ft)){nt=String(pt);break t}}nt=ft}var dt,vt={};function yt(u){return t=u,e=function(){for(var t=0,e=K(String(nt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(_.document&&ot){var gt=ht();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!yt("9"),It=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",S,e),_.removeEventListener("test",S,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},M(Tt,Et);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function Dt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function xt(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=F(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Gt(r);return e&&e[At]?e.sa(n,r,k(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=Gt(n),t&&t[At]?t.ra(e,n,k(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,c=Ft(t);if(c||(t[Pt]=c=new xt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[At])kt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(kt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Dt(t)}}}function Ut(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Mt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Vt(t),n.call(r,e)}function jt(t,e){if(t.V)return!0;if(wt)return Mt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=_,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Mt(t,e=new Tt(e,this))}function Ft(t){return(t=t[Pt])instanceof xt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==D(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Bt(){j.call(this),this.c=new xt(this),(this.J=this).A=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&kt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}M(Bt,j),Bt.prototype[At]=!0,(T=Bt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Gt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new Et(t,n);else if(t instanceof Et)t.target=t.target||n;else{var i=t;tt(t=new Et(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=zt(s,r,!0,t)&&i}if(i=zt(s=t.a=n,r,!0,t)&&i,i=zt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=zt(s=t.a=e[o],r,!1,t)&&i;return i},T.C=function(){if(Bt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=_.JSON.stringify;function Kt(){this.b=this.a=null}var Ht,$t=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Qt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t){_.setTimeout(function(){throw t},0)}function Jt(t,e){var n;Ht||(n=_.Promise.resolve(void 0),Ht=function(){n.then(ee)}),Zt||(Ht(),Zt=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=$t.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Kt;function ee(){for(var t;r=n=void 0,r=null,(n=te).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Yt(t)}var e=$t;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;Zt=!1}function ne(t,e){Bt.call(this),this.b=t||1,this.a=e||_,this.f=C(this.Ua,this),this.g=U()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function oe(t,e,n){j.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ue(t){j.call(this),this.b=t,this.a={}}M(ne,Bt),(T=ne.prototype).Z=!1,T.L=null,T.Ua=function(){if(this.Z){var t=U()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start()))}},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=U())},T.C=function(){ne.M.C.call(this),re(this),delete this.a},M(oe,j),(T=oe.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},T.C=function(){oe.M.C.call(this),this.T&&(_.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},M(ue,j);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Y(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new Bt}function de(t){Et.call(this,"serverreachability",t)}function ve(t){var e=pe();e.dispatchEvent(new de(e))}function ye(t){Et.call(this,"statevent",t)}function ge(t){var e=pe();e.dispatchEvent(new ye(e))}function me(t){Et.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}M(de,Et),M(ye,Et),M(me,Et);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ie={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ee(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ee.prototype.a=null;var Ae,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){Et.call(this,"d")}function De(){Et.call(this,"c")}function xe(){}function ke(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Oe,t=ut?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}M(Se,Et),M(De,Et),M(xe,Ee),Ae=new xe;var Oe=45e3,Pe={},Le={};function Re(t,e,n){t.B=1,t.f=nn(Qe(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=U(),Me(t),t.A=Qe(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.w=0,t.a=ur(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(C(t.ya,t,t.a),t.J)),ce(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ve(1)}function Ve(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=Ue(t,n);if(i==Le){4==e&&(t.c=4,ge(14),r=!1);break}if(i==Pe){t.c=4,ge(15),r=!1;break}Be(t,i)}4==e&&0==n.length&&(t.c=1,ge(16),r=!1),t.b=t.b&&r,r||(Ge(t),qe(t))}function Ue(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?Le:(n=Number(e.substring(n,r)),isNaN(n)?Pe:(r+=1)+n>e.length?Le:(e=e.substr(r,n),t.w=r+n,e))}function Me(t){t.P=U()+t.N,je(t,t.N)}function je(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(C(t.Qa,t),e)}function Fe(t){t.h&&(_.clearTimeout(t.h),t.h=null)}function qe(t){0==t.g.u||t.l||nr(t.g,t)}function Ge(t){Fe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),he(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||Tn(n.b,t)))if(n.A=t.H,!t.o&&Tn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;er(n),n.a.cancel(),n.a=null}tr(n),ge(18)}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=we(C(n.Na,n),6e3));if(En(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else ir(n,11)}else if(!t.o&&n.a!=t||er(n),!z(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var c=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(c){var h=u.b;!h.a&&(H(c,"spdy")||H(c,"quic")||H(c,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(Nn(h,h.b),h.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,en(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=sr(u,u.w?u.R:null,u.P),l.o){An(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(Fe(p),Me(p)),u.a=l}else Zn(u);0<n.f.length&&Xn(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):Kn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ve(4)}catch(t){}}function ze(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=ke.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Gn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.qa(),r=this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||ve(8==n||r<=0?3:2),Fe(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,ge(12),Ge(this),qe(this);break t}this.o=!0,Be(this,a)}this.F?(Ve(this,e,o),ut&&this.b&&3==e&&(ce(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,o),4==e&&Ge(this),this.b&&!this.l&&(4==e?nr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,ge(12)):(this.c=0,ge(13)),Ge(this),qe(this)}}}catch(t){}},T.Ra=function(){if(this.a){var t=Gn(this.a),e=this.a.Y();this.w<e.length&&(Fe(this),Ve(this,t,e),this.b&&4!=t&&Me(this))}},T.cancel=function(){this.l=!0,Ge(this)},T.Qa=function(){this.h=null;var t=U();0<=t-this.P?(2!=this.B&&(ve(3),ge(17)),Ge(this),this.c=2,qe(this)):je(this,this.P-t)},(T=We.prototype).I=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return Ke(this),this.a.concat()},T.get=function(t,e){return He(this.b,t)?this.b[t]:e},T.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe){this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b;var n=new ln;n.c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),tn(this,n),this.i=t.i}else t&&(n=String(t).match($e))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=rn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Qe(t){return new Xe(t)}function Ye(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function vn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function yn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),B(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ca&&_.ca.ua&&_.ca.ua()&&_.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){pn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){pn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},T.set=function(t,e){return pn(this),this.c=null,vn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var bn=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=E(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function Dn(){this.a=new Sn}function xn(t,r,e){var i=e||"";try{ze(t,function(t,e){var n=t;k(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function kn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=E(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var On=_.JSON.parse;function Pn(t){Bt.call(this),this.headers=new We,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Ln,this.B=this.F=!1}M(Pn,Bt);var Ln="",Rn=/^https?$/i,Cn=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),Fn(t)}function Mn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Gn(t)||2!=t.S()))if(t.l&&4==Gn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match($e)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}i=!Rn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Mn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Y(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=zn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=zn("baseRetryDelayMs",5e3,t),this.Ga=zn("retryDelaySeedMs",1e4,t),this.Da=zn("forwardChannelMaxRetries",2,t),this.ga=zn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new wn(t&&t.concurrentRequestLimit),this.ja=new Dn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Kn(t){if(Hn(t),3==t.u){var e=t.H++,n=Qe(t.v);en(n,"SID",t.B),en(n,"RID",e),en(n,"TYPE","terminate"),Yn(t,n),(e=new ke(t,e,void 0)).B=2,e.f=nn(Qe(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=ur(e.g,null),e.a.$(e.f)),e.s=U(),Me(e)}or(t)}function Hn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(_.clearTimeout(t.i),t.i=null),er(t),t.b.cancel(),t.g&&("number"==typeof t.g&&_.clearTimeout(t.g),t.g=null)}function $n(t,e){t.f.push(new mn(t.Fa++,e)),3==t.u&&Xn(t)}function Xn(t){In(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Qn(t,e){var n;n=e?e.W:t.H++;var r=Qe(t.v);en(r,"SID",t.B),en(r,"RID",n),en(r,"AID",t.G),Yn(t,r),t.h&&t.j&&Bn(r,t.h,t.j),n=new ke(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Nn(t.b,n),Re(n,r,e)}function Yn(t,n){t.c&&ze({},function(t,e){en(n,e,t)})}function Jn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{xn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Zn(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function tr(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(C(t.wa,t),rr(t,t.m)),t.m++,1)}function er(t){null!=t.l&&(_.clearTimeout(t.l),t.l=null)}function nr(t,e){var n=null;if(t.a==e){er(t),t.a=null;var r=2}else{if(!Tn(t.b,e))return;n=e.i,An(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=U()-e.s;var i=t.o;(r=pe()).dispatchEvent(new me(r)),Xn(t)}else Zn(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(C(t.xa,t,e),rr(t,t.o)),t.o++,1}}(t,e)||2==r&&tr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ir(t,e){if(2==e){var n=null;t.c&&(n=null);var r=C(t.Ta,t);n||(n=new Xe("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||Ye(n,"https"),nn(n)),function(t,e){var n=new fe;if(_.Image){var r=new Image;r.onload=V(kn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=V(kn,n,r,"TestLoadImage: error",!1,e),r.onabort=V(kn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=V(kn,n,r,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ge(2);t.u=0,t.c&&t.c.la(e),or(t),Hn(t)}function or(t){t.u=0,t.A=-1,t.c&&(0==_n(t.b).length&&0==t.f.length||(t.b.c.length=0,B(t.f),t.f.length=0),t.c.ka())}function sr(t,e,n){var r,i,o,s,u,a,c=(r=n)instanceof Xe?Qe(r):new Xe(r,void 0);if(""!=c.c)e&&Je(c,e+"."+c.c),Ze(c,c.h);else{var h=_.location;i=h.protocol,o=e?e+"."+h.hostname:h.hostname,s=+h.port,u=n,a=new Xe(null,void 0),i&&Ye(a,i),o&&Je(a,o),s&&Ze(a,s),u&&(a.g=u),c=a}return t.N&&Y(t.N,function(t,e){en(c,e,t)}),e=t.s,n=t.ha,e&&n&&en(c,e,n),en(c,"VER",t.oa),Yn(t,c),c}function ur(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ea)).F=t.w,e}function ar(){}function cr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Bt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){De.call(this),this.status=1}function pr(t){this.a=t}(T=Pn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Te(this.G):Te(Ae),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new We(this.headers);r&&ze(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=F(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},T.ta=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Pn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?jn(this):this.Oa())},T.Oa=function(){jn(this)},T.S=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Wn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new ke(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=J(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),en(i=Qe(this.v),"RID",t),en(i,"CVER",22),this.s&&en(i,"X-HTTP-Session-Id",this.s),Yn(this,i),this.h&&r&&Bn(i,this.h,r),Nn(this.b,n),this.fa?(en(i,"$req",e),en(i,"SID","null"),n.R=!0,Re(n,i,null)):Re(n,i,e),this.u=2}}else 3==this.u&&(t?Qn(this,t):0==this.f.length||In(this.b)||Qn(this))},T.wa=function(){this.i=null,this.a=new ke(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Qe(this.ea);en(t,"RID","rpc"),en(t,"SID",this.B),en(t,"CI",this.U?"0":"1"),en(t,"AID",this.G),Yn(this,t),en(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=nn(Qe(t)),e.j=null,e.F=!0,Ce(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,tr(this),ge(19))},T.Ta=function(t){ge(t?2:1)},(T=ar.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},M(hr,Bt),(T=hr.prototype).addEventListener=function(t,e,n,r){hr.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){hr.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(0),t.P=e,t.N=n||{},t.U=t.W,t.v=sr(t,null,t.P),Xn(t)},T.close=function(){Kn(this.a)},T.La=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.g?((e={}).__data__=Wt(t),$n(this.a,e)):$n(this.a,t)},T.C=function(){this.a.c=null,delete this.f,Kn(this.a),delete this.a,hr.M.C.call(this)},M(fr,Se),M(lr,De),M(pr,ar),pr.prototype.na=function(){this.a.dispatchEvent("a")},pr.prototype.ma=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.la=function(t){this.a.dispatchEvent(new lr)},pr.prototype.ka=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.La,hr.prototype.open=hr.prototype.Ka,hr.prototype.close=hr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Bt.prototype.listen=Bt.prototype.ra,Pn.prototype.listenOnce=Pn.prototype.sa,Pn.prototype.getLastError=Pn.prototype.Ma,Pn.prototype.getLastErrorCode=Pn.prototype.qa,Pn.prototype.getStatus=Pn.prototype.S,Pn.prototype.getResponseJson=Pn.prototype.Ja,Pn.prototype.getResponseText=Pn.prototype.Y,Pn.prototype.send=Pn.prototype.$;var dr={createWebChannelTransport:function(){return new cr},ErrorCode:be,EventType:Ie,WebChannel:Ne,XhrIo:Pn},vr=dr.createWebChannelTransport,yr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=(Ir.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ir.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ir.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ir);function Ir(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er=new c("@firebase/firestore");function Tr(){return Er.logLevel}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=p.DEBUG){var r=e.map(_r);Er.debug.apply(Er,d(["Firestore (7.17.1): "+t],r))}}function Ar(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=p.ERROR){var r=e.map(_r);Er.error.apply(Er,d(["Firestore (7.17.1): "+t],r))}}function _r(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Sr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.1) INTERNAL ASSERTION FAILED: "+t;throw Ar(e),new Error(e)}function Dr(t){t||Sr()}function xr(t){return t}function kr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Or=(Pr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=kr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Pr);function Pr(){}function Lr(t,e){return t<e?-1:e<t?1:0}function Rr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Cr(t){return t+"\0"}function Vr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ur=(Object.defineProperty(Mr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Mr.prototype.isEqual=function(t){return t instanceof Mr&&t.projectId===this.projectId&&t.database===this.database},Mr.prototype.o=function(t){return Lr(this.projectId,t.projectId)||Lr(this.database,t.database)},Mr);function Mr(t,e){this.projectId=t,this.database=e||"(default)"}function jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Gr,Br,zr,Wr=(ai.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},ai.prototype.has=function(t){return void 0!==this.get(t)},ai.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},ai.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},ai.prototype.forEach=function(u){Fr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},ai.prototype._=function(){return qr(this.l)},ai),Kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Hr=(n(ui,zr=Error),ui),$r=(si.now=function(){return si.fromMillis(Date.now())},si.fromDate=function(t){return si.fromMillis(t.getTime())},si.fromMillis=function(t){var e=Math.floor(t/1e3);return new si(e,1e6*(t-1e3*e))},si.prototype.toDate=function(){return new Date(this.toMillis())},si.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},si.prototype.T=function(t){return this.seconds===t.seconds?Lr(this.nanoseconds,t.nanoseconds):Lr(this.seconds,t.seconds)},si.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},si.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},si.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},si),Xr=(oi.I=function(t){return new oi(t)},oi.min=function(){return new oi(new $r(0,0))},oi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},oi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},oi.prototype.A=function(){return this.timestamp},oi),Qr=(Object.defineProperty(ii.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ii.prototype.isEqual=function(t){return 0===ii.P(this,t)},ii.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ii?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ii.prototype.limit=function(){return this.offset+this.length},ii.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ii.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ii.prototype.v=function(){return this.segments[this.offset]},ii.prototype.S=function(){return this.get(this.length-1)},ii.prototype.get=function(t){return this.segments[this.offset+t]},ii.prototype._=function(){return 0===this.length},ii.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ii.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ii.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},ii.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ii),Yr=(n(ri,Br=Qr),ri.prototype.g=function(t,e,n){return new ri(t,e,n)},ri.prototype.$=function(){return this.F().join("/")},ri.prototype.toString=function(){return this.$()},ri.N=function(t){if(0<=t.indexOf("//"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ri(t.split("/").filter(function(t){return 0<t.length}))},ri.k=function(){return new ri([])},ri),Jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Zr=(n(ni,Gr=Qr),ni.prototype.g=function(t,e,n){return new ni(t,e,n)},ni.M=function(t){return Jr.test(t)},ni.prototype.$=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ni.M(t)||(t="`"+t+"`"),t}).join(".")},ni.prototype.toString=function(){return this.$()},ni.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},ni.L=function(){return new ni(["__name__"])},ni.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Hr(Kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Hr(Kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ni(e)},ni.k=function(){return new ni([])},ni),ti=(ei.B=function(t){return new ei(Yr.N(t).V(5))},ei.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ei.prototype.isEqual=function(t){return null!==t&&0===Yr.P(this.path,t.path)},ei.prototype.toString=function(){return this.path.toString()},ei.P=function(t,e){return Yr.P(t.path,e.path)},ei.W=function(t){return t.length%2==0},ei.j=function(t){return new ei(new Yr(t.slice()))},ei);function ei(t){this.path=t}function ni(){return null!==Gr&&Gr.apply(this,arguments)||this}function ri(){return null!==Br&&Br.apply(this,arguments)||this}function ii(t,e,n){void 0===e?e=0:e>t.length&&Sr(),void 0===n?n=t.length-e:n>t.length-e&&Sr(),this.segments=t,this.offset=e,this.R=n}function oi(t){this.timestamp=t}function si(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Hr(Kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ui(t,e){var n=this;return(n=zr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function ai(t,e){this.h=t,this.u=e,this.l={}}function ci(t){return null==t}function hi(t){return-0===t&&1/t==-1/0}function fi(t){return"number"==typeof t&&Number.isInteger(t)&&!hi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var li=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function pi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new li(t,e,n,r,i,o,s)}function di(t){var e=xr(t);if(null===e.K){var n=e.path.$();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return(e=t).field.$()+e.op.toString()+Io(e.value);var e}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.$()+e.dir;var e}).join(","),ci(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=$u(e.startAt)),e.endAt&&(n+="|ub:",n+=$u(e.endAt)),e.K=n}return e.K}function vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(r=t.orderBy[n],i=e.orderBy[n],r.dir!==i.dir||!r.field.isEqual(i.field))return!1;var r,i,o,s;if(t.filters.length!==e.filters.length)return!1;for(var u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],!(o instanceof ku&&s instanceof ku&&o.op===s.op&&o.field.isEqual(s.field)&&go(o.value,s.value)))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qu(t.startAt,e.startAt)&&Qu(t.endAt,e.endAt)}function yi(t){return ti.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.G,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},mi.prototype.H=function(){return 2*this.G.length},mi.prototype.o=function(t){return Lr(this.G,t.G)},mi.prototype.isEqual=function(t){return this.G===t.G},mi);function mi(t){this.G=t}gi.Y=new gi("");function wi(t){this.count=t}var bi,Ii,Ei=(Ti.prototype.Z=function(t){return new Ti(this.target,this.targetId,this.J,t,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ti.prototype.tt=function(t,e){return new Ti(this.target,this.targetId,this.J,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ti.prototype.et=function(t){return new Ti(this.target,this.targetId,this.J,this.sequenceNumber,this.X,t,this.resumeToken)},Ti);function Ti(t,e,n,r,i,o,s){void 0===i&&(i=Xr.min()),void 0===o&&(o=Xr.min()),void 0===s&&(s=gi.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case Kr.OK:return Sr();case Kr.CANCELLED:case Kr.UNKNOWN:case Kr.DEADLINE_EXCEEDED:case Kr.RESOURCE_EXHAUSTED:case Kr.INTERNAL:case Kr.UNAVAILABLE:case Kr.UNAUTHENTICATED:return;case Kr.INVALID_ARGUMENT:case Kr.NOT_FOUND:case Kr.ALREADY_EXISTS:case Kr.PERMISSION_DENIED:case Kr.FAILED_PRECONDITION:case Kr.ABORTED:case Kr.OUT_OF_RANGE:case Kr.UNIMPLEMENTED:case Kr.DATA_LOSS:return 1;default:return Sr()}}function Ai(t){if(void 0===t)return Ar("GRPC error has no .code"),Kr.UNKNOWN;switch(t){case bi.OK:return Kr.OK;case bi.CANCELLED:return Kr.CANCELLED;case bi.UNKNOWN:return Kr.UNKNOWN;case bi.DEADLINE_EXCEEDED:return Kr.DEADLINE_EXCEEDED;case bi.RESOURCE_EXHAUSTED:return Kr.RESOURCE_EXHAUSTED;case bi.INTERNAL:return Kr.INTERNAL;case bi.UNAVAILABLE:return Kr.UNAVAILABLE;case bi.UNAUTHENTICATED:return Kr.UNAUTHENTICATED;case bi.INVALID_ARGUMENT:return Kr.INVALID_ARGUMENT;case bi.NOT_FOUND:return Kr.NOT_FOUND;case bi.ALREADY_EXISTS:return Kr.ALREADY_EXISTS;case bi.PERMISSION_DENIED:return Kr.PERMISSION_DENIED;case bi.FAILED_PRECONDITION:return Kr.FAILED_PRECONDITION;case bi.ABORTED:return Kr.ABORTED;case bi.OUT_OF_RANGE:return Kr.OUT_OF_RANGE;case bi.UNIMPLEMENTED:return Kr.UNIMPLEMENTED;case bi.DATA_LOSS:return Kr.DATA_LOSS;default:return Sr()}}(Ii=bi=bi||{})[Ii.OK=0]="OK",Ii[Ii.CANCELLED=1]="CANCELLED",Ii[Ii.UNKNOWN=2]="UNKNOWN",Ii[Ii.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ii[Ii.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ii[Ii.NOT_FOUND=5]="NOT_FOUND",Ii[Ii.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ii[Ii.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ii[Ii.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ii[Ii.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ii[Ii.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ii[Ii.ABORTED=10]="ABORTED",Ii[Ii.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ii[Ii.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ii[Ii.INTERNAL=13]="INTERNAL",Ii[Ii.UNAVAILABLE=14]="UNAVAILABLE",Ii[Ii.DATA_LOSS=15]="DATA_LOSS";var _i=(Oi.prototype.nt=function(t,e){return new Oi(this.P,this.root.nt(t,e,this.P).copy(null,null,Di.st,null,null))},Oi.prototype.remove=function(t){return new Oi(this.P,this.root.remove(t,this.P).copy(null,null,Di.st,null,null))},Oi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Oi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Oi.prototype._=function(){return this.root._()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Oi.prototype.it=function(){return this.root.it()},Oi.prototype.rt=function(){return this.root.rt()},Oi.prototype.ot=function(t){return this.root.ot(t)},Oi.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Oi.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Oi.prototype.ht=function(t){return this.root.ht(t)},Oi.prototype.at=function(){return new Si(this.root,null,this.P,!1)},Oi.prototype.ut=function(t){return new Si(this.root,t,this.P,!1)},Oi.prototype.ct=function(){return new Si(this.root,null,this.P,!0)},Oi.prototype.lt=function(t){return new Si(this.root,t,this.P,!0)},Oi),Si=(ki.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},ki.prototype.wt=function(){return 0<this.ft.length},ki.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},ki),Di=(xi.prototype.copy=function(t,e,n,r,i){return new xi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},xi.prototype._=function(){return!1},xi.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},xi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},xi.prototype.min=function(){return this.left._()?this:this.left.min()},xi.prototype.it=function(){return this.min().key},xi.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},xi.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},xi.prototype.It=function(){if(this.left._())return xi.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.copy(null,null,null,t.left.It(),null)).Et()},xi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.gt()),0===e(t,r.key)){if(r.right._())return xi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.It())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Et()},xi.prototype.At=function(){return this.color},xi.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},xi.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},xi.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},xi.prototype.Vt=function(){var t=this.copy(null,null,xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},xi.prototype.Pt=function(){var t=this.copy(null,null,xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},xi.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},xi.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},xi.prototype.bt=function(){if(this.At()&&this.left.At())throw Sr();if(this.right.At())throw Sr();var t=this.left.bt();if(t!==this.right.bt())throw Sr();return t+(this.At()?0:1)},xi);function xi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:xi.RED,this.left=null!=r?r:xi.EMPTY,this.right=null!=i?i:xi.EMPTY,this.size=this.left.size+1+this.right.size}function ki(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Oi(t,e){this.P=t,this.root=e||Di.EMPTY}function Pi(){this.size=0}Di.EMPTY=null,Di.RED=!0,Di.st=!1,Di.EMPTY=(Object.defineProperty(Pi.prototype,"key",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"value",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"color",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"left",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Object.defineProperty(Pi.prototype,"right",{get:function(){throw Sr()},enumerable:!1,configurable:!0}),Pi.prototype.copy=function(t,e,n,r,i){return this},Pi.prototype.nt=function(t,e,n){return new Di(t,e)},Pi.prototype.remove=function(t,e){return this},Pi.prototype._=function(){return!0},Pi.prototype.ot=function(t){return!1},Pi.prototype.ht=function(t){return!1},Pi.prototype.it=function(){return null},Pi.prototype.rt=function(){return null},Pi.prototype.At=function(){return!1},Pi.prototype.pt=function(){return!0},Pi.prototype.bt=function(){return 0},new Pi);var Li=(Ui.prototype.has=function(t){return null!==this.data.get(t)},Ui.prototype.first=function(){return this.data.it()},Ui.prototype.last=function(){return this.data.rt()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ui.prototype.indexOf=function(t){return this.data.indexOf(t)},Ui.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Ui.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Ui.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Ui.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Ui.prototype.at=function(){return new Ri(this.data.at())},Ui.prototype.ut=function(t){return new Ri(this.data.ut(t))},Ui.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},Ui.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ui.prototype._=function(){return this.data._()},Ui.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ui.prototype.isEqual=function(t){if(!(t instanceof Ui))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Ui.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ui.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ui.prototype.copy=function(t){var e=new Ui(this.P);return e.data=t,e},Ui),Ri=(Vi.prototype.dt=function(){return this.Ft.dt().key},Vi.prototype.wt=function(){return this.Ft.wt()},Vi),Ci=new _i(ti.P);function Vi(t){this.Ft=t}function Ui(t){this.P=t,this.data=new _i(this.P)}function Mi(){return Ci}function ji(){return Mi()}var Fi=new _i(ti.P);function qi(){return Fi}var Gi=new _i(ti.P),Bi=new Li(ti.P);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Wi=new Li(Lr);function Ki(){return Wi}function Hi(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function $i(t,e){this.targetId=t,this.ee=e}function Xi(t,e,n,r){void 0===n&&(n=gi.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Qi=(co.kt=function(t){return new co(t.P)},co.prototype.has=function(t){return null!=this.$t.get(t)},co.prototype.get=function(t){return this.$t.get(t)},co.prototype.first=function(){return this.Nt.it()},co.prototype.last=function(){return this.Nt.rt()},co.prototype._=function(){return this.Nt._()},co.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(co.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),co.prototype.forEach=function(n){this.Nt.ot(function(t,e){return n(t),!1})},co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.Nt.at(),n=t.Nt.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},co.prototype.copy=function(t,e){var n=new co;return n.P=this.P,n.$t=t,n.Nt=e,n},co),Yi=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):Sr()},ao.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},ao),Ji=(uo.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new uo(t,e,Qi.kt(e),i,n,r,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&Nu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},uo),Zi=(so.Gt=function(t,e){var n=new Map;return n.set(t,to.zt(t,e)),new so(Xr.min(),n,Ki(),Mi(),zi())},so),to=(oo.zt=function(t,e){return new oo(gi.Y,e,zi(),zi(),zi())},oo),eo=(Object.defineProperty(io.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(io.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),io.prototype.ue=function(t){0<t.H()&&(this.oe=!0,this.ie=t)},io.prototype.ce=function(){var n=zi(),r=zi(),i=zi();return this.se.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Sr()}}),new to(this.ie,this.re,n,r,i)},io.prototype.le=function(){this.oe=!1,this.se=fo()},io.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},io.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},io.prototype.de=function(){this.ne+=1},io.prototype.we=function(){--this.ne},io.prototype.Te=function(){this.oe=!0,this.re=!0},io),no=(ro.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof uu?this.ge(r,t.te):t.te instanceof au&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Ve(s,t.key,t.te)}},ro.prototype.ye=function(n){var r=this;this.pe(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Sr()}})},ro.prototype.pe=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},ro.prototype.De=function(t){var e=t.targetId,n=t.ee.count,r=this.Ce(e);if(r){var i=r.target;if(yi(i))if(0===n){var o=new ti(i.path);this.Ve(e,o,new au(o,Xr.min()))}else Dr(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Re=this.Re.add(e))}},ro.prototype.$e=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n=o.Ce(e);if(n){if(t.Ht&&yi(n.target)){var r=new ti(n.target.path);null!==o.me.get(r)||o.Ne(e,r)||o.Ve(e,r,new au(r,i))}t.ae&&(s.set(e,t.ce()),t.le())}});var r=zi();this.Ae.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.J||(n=!1)}),n&&(r=r.add(t))});var t=new Zi(i,s,this.Re,this.me,r);return this.me=Mi(),this.Ae=ho(),this.Re=new Li(Lr),t},ro.prototype.ge=function(t,e){if(this.ve(t)){var n=this.Ne(t,e.key)?2:0;this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t))}},ro.prototype.Ve=function(t,e,n){if(this.ve(t)){var r=this.be(t);this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.me=this.me.nt(e,n))}},ro.prototype.removeTarget=function(t){this.Ie.delete(t)},ro.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},ro.prototype.de=function(t){this.be(t).de()},ro.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new eo,this.Ie.set(t,e)),e},ro.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new Li(Lr),this.Ae=this.Ae.nt(t,e)),e},ro.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},ro.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},ro.prototype.Se=function(e){var n=this;this.Ie.set(e,new eo),this.Ee.xe(e).forEach(function(t){n.Ve(e,t,null)})},ro.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},ro);function ro(t){this.Ee=t,this.Ie=new Map,this.me=Mi(),this.Ae=ho(),this.Re=new Li(Lr)}function io(){this.ne=0,this.se=fo(),this.ie=gi.Y,this.re=!1,this.oe=!0}function oo(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function so(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}function uo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}function ao(){this.xt=new _i(ti.P)}function co(n){this.P=n?function(t,e){return n(t,e)||ti.P(t.key,e.key)}:function(t,e){return ti.P(t.key,e.key)},this.$t=qi(),this.Nt=new _i(this.P)}function ho(){return new _i(ti.P)}function fo(){return new _i(ti.P)}function lo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function po(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new $r(e.seconds,e.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lo(t)?4:10:Sr()}function go(i,t){var e,n,r,o=yo(i);if(o!==yo(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return po(i).isEqual(po(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Eo(i.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,No(i.bytesValue).isEqual(No(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,To((e=i).geoPointValue.latitude)===To(n.geoPointValue.latitude)&&To(e.geoPointValue.longitude)===To(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return To(t.integerValue)===To(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=To(t.doubleValue),r=To(e.doubleValue);return n===r?hi(n)===hi(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return Rr(i.arrayValue.values||[],t.arrayValue.values||[],go);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(jr(e)!==jr(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!go(e[r],n[r])))return!1;return!0}(t);default:return Sr()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,r,i,o,s,u,a,c,h,f,l=yo(t),p=yo(e);if(l!==p)return Lr(l,p);switch(l){case 0:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return c=e,h=To(t.integerValue||t.doubleValue),f=To(c.integerValue||c.doubleValue),h<f?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return Lr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=No(o),a=No(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Lr(n[i],r[i]);if(0!==o)return o}return Lr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Lr(To(n.latitude),To(r.latitude)))?i:Lr(To(n.longitude),To(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wo(n[i],r[i]);if(o)return o}return Lr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Lr(r[s],o[s]);if(0!==u)return u;var a=wo(n[r[s]],i[o[s]]);if(0!==a)return a}return Lr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Sr()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Lr(t,e);var n=Eo(t),r=Eo(e),i=Lr(n.seconds,r.seconds);return 0!==i?i:Lr(n.nanos,r.nanos)}function Io(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?No(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ti.B(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Sr();var t,e,n}(t)}function Eo(t){if(Dr(!!t),"string"!=typeof t)return{seconds:To(t.seconds),nanos:To(t.nanos)};var e=0,n=vo.exec(t);if(Dr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function To(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function No(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function Ao(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function _o(t){return t&&"integerValue"in t}function So(t){return!!t&&"arrayValue"in t}function Do(t){return t&&"nullValue"in t}function xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ko(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.s=t,this.Oe=e};function Ro(t){return{integerValue:""+t}}function Co(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hi(e)?"-0":e}}function Vo(t,e){return fi(e)?Ro(e):Co(t,e)}function Uo(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function jo(t){return Dr(!!t),Xr.I((e=Eo(t),new $r(e.seconds,e.nanos)));var e}function Fo(t,e){return new Yr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).$()}function qo(t){var e=Yr.N(t);return Dr(rs(e)),e}function Go(t,e){return Fo(t.s,e.path)}function Bo(t,e){var n=qo(e);return Dr(n.get(1)===t.s.projectId),Dr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ti(Ho(n))}function zo(t,e){return Fo(t.s,e)}function Wo(t){var e=qo(t);return 4===e.length?Yr.k():Ho(e)}function Ko(t){return new Yr(["projects",t.s.projectId,"databases",t.s.database]).$()}function Ho(t){return Dr(4<t.length&&"documents"===t.get(4)),t.V(5)}function $o(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Xo(t,e){var n,r,i,o,s,u,a;if(e instanceof Vs)n={update:$o(t,e.key,e.value)};else if(e instanceof $s)n={delete:Go(t,e.key)};else if(e instanceof Us)n={update:$o(t,e.key,e.data),updateMask:(r=e.Le,i=[],r.fields.forEach(function(t){return i.push(t.$())}),{fieldPaths:i})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.$(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.$(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.$(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.$(),increment:e.qe};throw Sr()}(t)})}};else{if(!(e instanceof Xs))return Sr();n={verify:Go(t,e.key)}}return e.Ue.Be||(n.currentDocument=(o=t,void 0!==(s=e.Ue).updateTime?{updateTime:(u=o,a=s.updateTime,Uo(u,a.A()))}:void 0!==s.exists?{exists:s.exists}:Sr())),n}function Qo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?_s.updateTime(jo(n.updateTime)):void 0!==n.exists?_s.exists(n.exists):_s.We():_s.We();if(t.update){t.update.name;var o=Bo(e,t.update.name),s=new Qs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Es(r.map(function(t){return Zr.q(t)})));return new Us(o,s,u,i)}return new Vs(o,s,i)}if(t.delete){var a=Bo(e,t.delete);return new $s(a,i)}if(t.transform){var c=Bo(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n=null;if("setToServerValue"in e)Dr("REQUEST_TIME"===e.setToServerValue),n=new as;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new cs(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ds(i)}else"increment"in e?n=new ms(t,e.increment):Sr();var o=Zr.q(e.fieldPath);return new Ts(o,n)}(e,t)});return Dr(!0===i.exists),new Gs(c,h)}if(t.verify){var f=Bo(e,t.verify);return new Xs(f,i)}return Sr()}function Yo(t,e){return{documents:[zo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof ku?function(t){if("=="===t.op){if(xo(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,Po[e]),value:t.value}};var e}(t):Sr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:es((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u,a=(s=t,u=e.limit,s.Oe||ci(u)?u:{value:u});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,n=t.values||[];return new Gu(n,e)}function es(t){return{fieldPath:t.$()}}function ns(t){return Zr.q(t.fieldPath)}function rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function is(){this.Qe=void 0}function os(t,e){return t instanceof ms?_o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var ss,us,as=(n(fs,us=is),fs),cs=(n(hs,ss=is),hs);function hs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=Is(e),r=function(e){n.some(function(t){return go(t,e)})||n.push(e)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ps,ds=(n(vs,ps=is),vs);function vs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ys(t,e){for(var n=Is(e),r=function(e){n=n.filter(function(t){return!go(t,e)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=is),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).serializer=t,n.qe=e,n}function bs(t){return To(t.integerValue||t.doubleValue)}function Is(t){return So(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=(Ns.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ns.prototype.isEqual=function(t){return Rr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ns),Ts=function(t,e){this.field=t,this.transform=e};function Ns(t){(this.fields=t).sort(Zr.P)}function As(t,e){this.version=t,this.transformResults=e}var _s=(Ss.We=function(){return new Ss},Ss.exists=function(t){return new Ss(void 0,t)},Ss.updateTime=function(t){return new Ss(t)},Object.defineProperty(Ss.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ss.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ss);function Ss(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof uu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof uu}function xs(){}function ks(t,e,n){return t instanceof Vs?(i=n,new uu(t.key,i.version,t.value,{hasCommittedMutations:!0})):t instanceof Us?function(t,e,n){if(!Ds(t.Ue,e))return new cu(t.key,n.version);var r=Fs(t,e);return new uu(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Dr(null!=n.transformResults),!Ds(t.Ue,e))return new cu(t.key,n.version);var r=zs(0,e),i=function(t,e,n){var r,i,o,s=[];Dr(t.length===n.length);for(var u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof uu&&(h=e.field(a.field)),s.push((r=c,i=h,o=n[u],r instanceof cs?ls(r,i):r instanceof ds?ys(r,i):o))}return s}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ws(t,r.data(),i);return new uu(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):(r=n,new au(t.key,r.version,{hasCommittedMutations:!0}));var r,i}function Os(t,e,n,r){return t instanceof Vs?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e);return new uu(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Us?function(t,e){if(!Ds(t.Ue,e))return e;var n=Ls(e),r=Fs(t,e);return new uu(t.key,n,r,{Ke:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!Ds(t.Ue,e))return e;var i=zs(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof uu&&(c=n.field(u.field)),null===c&&r instanceof uu&&(c=r.field(u.field)),i.push((f=c,l=e,y=v=d=p=void 0,(h=a)instanceof as?(y={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}},f&&(y.fields.__previous_value__=f),{mapValue:y}):h instanceof cs?ls(h,f):h instanceof ds?ys(h,f):(d=os(p=h,f),v=bs(d)+bs(p.qe),_o(d)&&_o(p.qe)?Ro(v):Co(p.serializer,v))))}var h,f,l,p,d,v,y;return i}(t.fieldTransforms,n,e,r),s=Ws(t,i.data(),o);return new uu(t.key,i.version,s,{Ke:!0})}(t,e,r,n):(o=e,Ds((i=t).Ue,o)?new au(i.key,Xr.min()):o);var i,o}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||Rr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof cs&&o instanceof cs||i instanceof ds&&o instanceof ds?Rr(i.elements,o.elements,go):i instanceof ms&&o instanceof ms?go(i.qe,o.qe):i instanceof as&&o instanceof as);var n,r,i,o}))}function Ls(t){return t instanceof uu?t.version:Xr.min()}var Rs,Cs,Vs=(n(js,Cs=xs),js),Us=(n(Ms,Rs=xs),Ms);function Ms(t,e,n,r){var i=this;return(i=Rs.call(this)||this).key=t,i.data=e,i.Le=n,i.Ue=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Cs.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Fs(t,e){return n=t,r=e instanceof uu?e.data():Qs.empty(),i=new Ys(r),n.Le.fields.forEach(function(t){if(!t._()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.Ge();var n,r,i}var qs,Gs=(n(Bs,qs=xs),Bs);function Bs(t,e){var n=this;return(n=qs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=_s.exists(!0),n}function zs(t,e){return e}function Ws(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ge()}var Ks,Hs,$s=(n(eu,Hs=xs),eu),Xs=(n(tu,Ks=xs),tu),Qs=(Zs.empty=function(){return new Zs({mapValue:{}})},Zs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ko(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Zs.prototype.isEqual=function(t){return go(this.proto,t.proto)},Zs),Ys=(Js.prototype.set=function(t,e){return this.Ye(t,e),this},Js.prototype.delete=function(t){return this.Ye(t,null),this},Js.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},Js.prototype.Ge=function(){var t=this.Je(Zr.k(),this.He);return null!=t?new Qs(t):this.ze},Js.prototype.Je=function(r,t){var i=this,o=!1,e=this.ze.field(r),s=ko(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.Je(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Js);function Js(t){void 0===t&&(t=Qs.empty()),this.ze=t,this.He=new Map}function Zs(t){this.proto=t}function tu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ue=e,n.type=4,n}function eu(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function nu(t){var u=[];return Fr(t.fields||{},function(t,e){var n=new Zr([t]);if(ko(e)){var r=nu(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Es(u)}function ru(t,e){this.key=t,this.version=e}var iu,ou,su,uu=(n(lu,su=ru),lu.prototype.field=function(t){return this.Xe.field(t)},lu.prototype.data=function(){return this.Xe},lu.prototype.Ze=function(){return this.Xe.proto},lu.prototype.isEqual=function(t){return t instanceof lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu),au=(n(fu,ou=ru),fu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),cu=(n(hu,iu=ru),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu);function hu(){return null!==iu&&iu.apply(this,arguments)||this}function fu(t,e,n){var r=this;return(r=ou.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function lu(t,e,n,r){var i=this;return(i=su.call(this,t,e)||this).Xe=n,i.Ke=!!r.Ke,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function pu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Hr(Kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Hr(Kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var du=(vu.prototype.rn=function(t){return new vu(t,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},vu.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},vu.prototype.hn=function(){return!ci(this.limit)&&"F"===this.en},vu.prototype.an=function(){return!ci(this.limit)&&"L"===this.en},vu.prototype.un=function(){return 0<this.tn.length?this.tn[0].field:null},vu.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},vu.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},vu);function vu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null,this.startAt,this.endAt}function yu(t,e,n,r,i,o,s,u){return new du(t,e,n,r,i,o,s,u)}function gu(t){return new du(t)}function mu(t){return null!==t.collectionGroup}function wu(t){var e=pu(t,du);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Yu(n)),e.nn.push(new Yu(Zr.L(),"asc"));else{for(var i=!1,o=0,s=e.tn;o<s.length;o++){var u=s[o];e.nn.push(u),u.field.O()&&(i=!0)}if(!i){var a=0<e.tn.length?e.tn[e.tn.length-1].dir:"asc";e.nn.push(new Yu(Zr.L(),a))}}}return e.nn}function bu(t){var e=pu(t,du);if(!e.sn)if("F"===e.en)e.sn=pi(e.path,e.collectionGroup,wu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=wu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Yu(o.field,s))}var u=e.endAt?new Gu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Gu(e.startAt.position,!e.startAt.before):null;e.sn=pi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.sn}function Iu(t,e,n){return new du(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return new du(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function Tu(t,e){return new du(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function Nu(t,e){return vi(bu(t),bu(e))&&t.en===e.en}function Au(t){return di(bu(t))+"|lt:"+t.en}function _u(t){return"Query(target="+(e=bu(t),n=e.path.$(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.$()+" "+e.op+" "+Io(e.value);var e}).join(", ")+"]"),ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.$()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+$u(e.startAt)),e.endAt&&(n+=", endAt: "+$u(e.endAt)),"Target("+n+")")+"; limitType="+t.en+")";var e,n}function Su(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.U(r.collectionGroup)&&r.path.D(o):ti.W(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.tn;e<n.length;e++){var r=n[e];if(!r.field.O()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Xu(e.startAt,wu(e),n))&&(!e.endAt||!Xu(e.endAt,wu(e),n)));var e,n,r,o}function Du(u){return function(t,e){for(var n=!1,r=0,i=wu(u);r<i.length;r++){var o=i[r],s=Ju(o,t,e);if(0!==s)return s;n=n||o.field.O()}return 0}}var xu,ku=(n(Ou,xu=function(){}),Ou.create=function(t,e,n){if(t.O())return"in"===e?new Mu(t,n):new Uu(t,e,n);if(Do(n)){if("=="!==e)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Ou(t,e,n)}if(xo(n)){if("=="!==e)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Ou(t,e,n)}return"array-contains"===e?new ju(t,n):"in"===e?new Fu(t,n):"array-contains-any"===e?new qu(t,n):new Ou(t,e,n)},Ou.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value)===yo(e)&&this.fn(wo(e,this.value))},Ou.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Sr()}},Ou.prototype.ln=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Ou);function Ou(t,e,n){var r=this;return(r=xu.call(this)||this).field=t,r.op=e,r.value=n,r}var Pu,Lu,Ru,Cu,Vu,Uu=(n(Hu,Vu=ku),Hu.prototype.matches=function(t){var e=ti.P(t.key,this.key);return this.fn(e)},Hu),Mu=(n(Ku,Cu=ku),Ku.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ku),ju=(n(Wu,Ru=ku),Wu.prototype.matches=function(t){var e=t.field(this.field);return So(e)&&mo(e.arrayValue,this.value)},Wu),Fu=(n(zu,Lu=ku),zu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&mo(this.value.arrayValue,e)},zu),qu=(n(Bu,Pu=ku),Bu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!So(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Bu),Gu=function(t,e){this.position=t,this.before=e};function Bu(t,e){return Pu.call(this,t,"array-contains-any",e)||this}function zu(t,e){return Lu.call(this,t,"in",e)||this}function Wu(t,e){return Ru.call(this,t,"array-contains",e)||this}function Ku(t,e){var n=this;return(n=Cu.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ti.B(t.referenceValue)}),n}function Hu(t,e,n){var r=this;return(r=Vu.call(this,t,e,n)||this).key=ti.B(n.referenceValue),r}function $u(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return Io(t)}).join(",")}function Xu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.O()?ti.P(ti.B(s.referenceValue),n.key):wo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var Yu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ju(t,e,n){var r,i,o,s,u=t.field.O()?ti.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?wo(o,s):Sr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Sr()}}var Zu=(va.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ks(o,e,r[i]))}return e},va.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Os(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Os(a,e,o,this.dn))}return e},va.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.En(t.key,n.get(t.key));e&&(i=i.nt(t.key,e))}),i},va.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},va.prototype.isEqual=function(t){return this.batchId===t.batchId&&Rr(this.mutations,t.mutations,function(t,e){return Ps(t,e)})&&Rr(this.baseMutations,t.baseMutations,function(t,e){return Ps(t,e)})},va),ta=(da.from=function(t,e,n){Dr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.nt(i[o].key,n[o].version);return new da(t,e,n,r)},da),ea=(pa.prototype.catch=function(t){return this.next(void 0,t)},pa.prototype.next=function(r,i){var o=this;return this.Vn&&Sr(),this.Vn=!0,this.gn?this.error?this.yn(i,this.error):this.pn(r,this.result):new pa(function(e,n){o.Rn=function(t){o.pn(r,t).next(e,n)},o.Pn=function(t){o.yn(i,t).next(e,n)}})},pa.prototype.bn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},pa.prototype.vn=function(t){try{var e=t();return e instanceof pa?e:pa.resolve(e)}catch(t){return pa.reject(t)}},pa.prototype.pn=function(t,e){return t?this.vn(function(){return t(e)}):pa.resolve(e)},pa.prototype.yn=function(t,e){return t?this.vn(function(){return t(e)}):pa.reject(e)},pa.resolve=function(n){return new pa(function(t,e){t(n)})},pa.reject=function(n){return new pa(function(t,e){e(n)})},pa.Sn=function(t){return new pa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},pa.Dn=function(t){for(var n=pa.resolve(!1),e=function(e){n=n.next(function(t){return t?pa.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},pa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Sn(i)},pa),na=(Object.defineProperty(la.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),la.prototype.Nn=function(t,e){this.kn(),this.readTime=e,this.Cn.set(t.key,t)},la.prototype.xn=function(t,e){this.kn(),e&&(this.readTime=e),this.Cn.set(t,null)},la.prototype.Mn=function(t,e){this.kn();var n=this.Cn.get(e);return void 0!==n?ea.resolve(n):this.On(t,e)},la.prototype.getEntries=function(t,e){return this.Ln(t,e)},la.prototype.apply=function(t){return this.kn(),this.Fn=!0,this.qn(t)},la.prototype.kn=function(){},la),ra="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ia=(fa.prototype.Un=function(t){this.Bn.push(t)},fa.prototype.Wn=function(){this.Bn.forEach(function(t){return t()})},fa),oa=(ha.prototype.Gn=function(e,n){var r=this;return this.jn.zn(e,n).next(function(t){return r.Hn(e,n,t)})},ha.prototype.Hn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].En(r,t);return t})},ha.prototype.Yn=function(t,e,i){var o=ji();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].En(t,e);o=o.nt(t,e)}),o},ha.prototype.Jn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Xn(e,t)})},ha.prototype.Xn=function(r,i){var o=this;return this.jn.Zn(r,i).next(function(t){var e=o.Yn(r,i,t),n=Mi();return e.forEach(function(t,e){e=e||new au(t,Xr.min()),n=n.nt(t,e)}),n})},ha.prototype.ts=function(t,e,n){return r=e,ti.W(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.es(t,e.path):mu(e)?this.ns(t,e,n):this.ss(t,e,n);var r},ha.prototype.es=function(t,e){return this.Gn(t,new ti(e)).next(function(t){var e=qi();return t instanceof uu&&(e=e.nt(t.key,t)),e})},ha.prototype.ns=function(n,r,i){var o=this,s=r.collectionGroup,u=qi();return this.Kn.rs(n,s).next(function(t){return ea.forEach(t,function(t){var e=r.rn(t.child(s));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},ha.prototype.ss=function(e,n,t){var h,f,r=this;return this.Qn.ts(e,n,t).next(function(t){return h=t,r.jn.os(e,n)}).next(function(t){return f=t,r.hs(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=Os(s,a,a,r.dn);h=c instanceof uu?h.nt(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Su(n,e)||(h=h.remove(t))}),h})},ha.prototype.hs=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Us&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof uu&&(c=c.nt(t,e))}),c})},ha),sa=(ca.cs=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ca(t,e.fromCache,n,r)},ca),ua=(aa.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},aa.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},aa);function aa(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}function ca(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}function ha(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}function fa(){this.Bn=[]}function la(){this.Cn=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Fn=!1}function pa(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t(function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)})}function da(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}function va(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}ua.ws=-1;function ya(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ga=(ma.prototype.reset=function(){this.Rs=0},ma.prototype.Vs=function(){this.Rs=this.As},ma.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,function(){return e.gs=Date.now(),t()}),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},ma.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},ma.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},ma.prototype.ps=function(){return(Math.random()-.5)*this.Rs},ma);function ma(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}function wa(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Ia(e)),e=ba(t.get(n),e);return Ia(e)}function ba(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ia(t){return t+""}function Ea(t){var e=t.length;if(Dr(2<=e),2===e)return Dr(""===t.charAt(0)&&""===t.charAt(1)),Yr.k();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Sr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Sr()}o=s+2}return new Yr(r)}var Ta=(Da.prototype.Cs=function(t,e){return this.Ds.add(e),ea.resolve()},Da.prototype.rs=function(t,e){return ea.resolve(this.Ds.getEntries(e))},Da),Na=(Sa.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Li(Yr.P),i=!r.has(n);return this.index[e]=r.add(n),i},Sa.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Sa.prototype.getEntries=function(t){return(this.index[t]||new Li(Yr.P)).F()},Sa),Aa=(_a.prototype.Cs=function(t,e){var n=this;if(this.Fs.has(e))return ea.resolve();var r=e.S(),i=e.p();t.Un(function(){n.Fs.add(e)});var o={collectionId:r,parent:wa(i)};return xa(t).put(o)},_a.prototype.rs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Cr(i),""],!1,!0);return xa(t).$s(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Ea(r.parent))}return o})},_a);function _a(){this.Fs=new Na}function Sa(){this.index={}}function Da(){this.Ds=new Na}function xa(t){return ic.Ns(t,Vc.store)}function ka(t){this.ks=t}function Oa(t,e){if(e.document)return n=t.ks,r=e.document,i=!!e.hasCommittedMutations,o=Bo(n,r.name),s=jo(r.updateTime),u=new Qs({mapValue:{fields:r.fields}}),new uu(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ti.j(e.noDocument.path),c=Va(e.noDocument.readTime);return new au(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=ti.j(e.unknownDocument.path),f=Va(e.unknownDocument.version);return new cu(h,f)}return Sr()}function Pa(t,e,n){var r,i,o=La(n),s=e.key.path.p().F();if(e instanceof uu){var u={name:Go(r=t.ks,(i=e).key),fields:i.Ze().mapValue.fields,updateTime:Uo(r,i.version.A())},a=e.hasCommittedMutations;return new Oc(null,null,u,a,o,s)}if(e instanceof au){var c=e.key.path.F(),h=Ca(e.version),f=e.hasCommittedMutations;return new Oc(null,new xc(c,h),null,f,o,s)}if(e instanceof cu){var l=e.key.path.F(),p=Ca(e.version);return new Oc(new kc(l,p),null,null,!0,o,s)}return Sr()}function La(t){var e=t.A();return[e.seconds,e.nanoseconds]}function Ra(t){var e=new $r(t[0],t[1]);return Xr.I(e)}function Ca(t){var e=t.A();return new Ec(e.seconds,e.nanoseconds)}function Va(t){var e=new $r(t.seconds,t.nanoseconds);return Xr.I(e)}function Ua(e,t){var n=(t.baseMutations||[]).map(function(t){return Qo(e.ks,t)}),r=t.mutations.map(function(t){return Qo(e.ks,t)}),i=$r.fromMillis(t.localWriteTimeMs);return new Zu(t.batchId,i,n,r)}function Ma(t){var e,n,r=Va(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Va(t.lastLimboFreeSnapshotVersion):Xr.min();return e=void 0!==t.query.documents?(Dr(1===(n=t.query).documents.length),bu(gu(Wo(n.documents[0])))):function(t){var e=Wo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Dr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function e(t){return t?void 0!==t.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return ku.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Sr()}}(t)]:void 0!==t.fieldFilter?[(n=t,ku.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Sr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Sr():[];var n}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return new Yu(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;n.limit&&(a=n.limit,h=ci(c="object"==typeof a?a.value:a)?null:c);var f=null;n.startAt&&(f=ts(n.startAt));var l=null;return n.endAt&&(l=ts(n.endAt)),bu(yu(e,i,u,s,h,"F",f,l))}(t.query),new Ei(e,t.targetId,0,t.lastListenSequenceNumber,r,i,gi.fromBase64String(t.resumeToken))}function ja(t,e){var n,r=Ca(e.X),i=Ca(e.lastLimboFreeSnapshotVersion);n=(yi(e.target)?Yo:Jo)(t.ks,e.target);var o=e.resumeToken.toBase64();return new Lc(e.targetId,di(e.target),r,o,e.sequenceNumber,i,n)}var Fa,qa=(Ga.prototype.Nn=function(t,e,n){return za(t).put(Wa(e),n)},Ga.prototype.xn=function(t,e){var n=za(t),r=Wa(e);return n.delete(r)},Ga.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.xs(e,t)})},Ga.prototype.Mn=function(t,e){var n=this;return za(t).get(Wa(e)).next(function(t){return n.Ms(t)})},Ga.prototype.Os=function(t,e){var n=this;return za(t).get(Wa(e)).next(function(t){var e=n.Ms(t);return e?{Ls:e,size:Ka(t)}:null})},Ga.prototype.getEntries=function(t,e){var r=this,i=ji();return this.qs(t,e,function(t,e){var n=r.Ms(e);i=i.nt(t,n)}).next(function(){return i})},Ga.prototype.Bs=function(t,e){var r=this,i=ji(),o=new _i(ti.P);return this.qs(t,e,function(t,e){var n=r.Ms(e);o=n?(i=i.nt(t,n),o.nt(t,Ka(e))):(i=i.nt(t,null),o.nt(t,0))}).next(function(){return{Us:i,Ws:o}})},Ga.prototype.qs=function(t,e,i){if(e._())return ea.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return za(t).Qs({range:n},function(t,e,n){for(var r=ti.j(t);s&&ti.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.js(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},Ga.prototype.ts=function(t,i,e){var o=this,s=qi(),u=i.path.length+1,n={};if(e.isEqual(Xr.min())){var r=i.path.F();n.range=IDBKeyRange.lowerBound(r)}else{var a=i.path.F(),c=La(e);n.range=IDBKeyRange.lowerBound([a,c],!0),n.index=Oc.collectionReadTimeIndex}return za(t).Qs(n,function(t,e,n){if(t.length===u){var r=Oa(o.serializer,e);i.path.D(r.key.path)?r instanceof uu&&Su(i,r)&&(s=s.nt(r.key,r)):n.done()}}).next(function(){return s})},Ga.prototype.Ks=function(t,e){var r=this,i=Mi(),o=La(e),n=za(t),s=IDBKeyRange.lowerBound(o,!0);return n.Qs({index:Oc.readTimeIndex,range:s},function(t,e){var n=Oa(r.serializer,e);i=i.nt(n.key,n),o=e.readTime}).next(function(){return{Gs:i,readTime:Ra(o)}})},Ga.prototype.zs=function(t){var e=za(t),r=Xr.min();return e.Qs({index:Oc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Ra(e.readTime)),n.done()}).next(function(){return r})},Ga.prototype.Hs=function(t){return new Ga.Ys(this,!!t&&t.Js)},Ga.prototype.Xs=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ga.prototype.getMetadata=function(t){return Ba(t).get(Pc.key).next(function(t){return Dr(!!t),t})},Ga.prototype.xs=function(t,e){return Ba(t).put(Pc.key,e)},Ga.prototype.Ms=function(t){if(t){var e=Oa(this.serializer,t);return e instanceof au&&e.version.isEqual(Xr.min())?null:e}return null},Ga);function Ga(t,e){this.serializer=t,this.Kn=e}function Ba(t){return ic.Ns(t,Pc.store)}function za(t){return ic.Ns(t,Oc.store)}function Wa(t){return t.path.F()}function Ka(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Sr();e=t.noDocument}return JSON.stringify(e).length}function Ha(t,e){var n=this;return(n=Fa.call(this)||this).Zs=t,n.Js=e,n.ti=new Wr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}qa.Ys=(n(Ha,Fa=na),Ha.prototype.qn=function(s){var u=this,a=[],c=0,h=new Li(function(t,e){return Lr(t.$(),e.$())});return this.Cn.forEach(function(t,e){var n=u.ti.get(t);if(e){var r=Pa(u.Zs.serializer,e,u.readTime);h=h.add(t.path.p());var i=Ka(r);c+=i-n,a.push(u.Zs.Nn(s,t,r))}else if(c-=n,u.Js){var o=Pa(u.Zs.serializer,new au(t,Xr.min()),u.readTime);a.push(u.Zs.Nn(s,t,o))}else a.push(u.Zs.xn(s,t))}),h.forEach(function(t){a.push(u.Zs.Kn.Cs(s,t))}),a.push(this.Zs.updateMetadata(s,c)),ea.Sn(a)},Ha.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next(function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)})},Ha.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next(function(t){var e=t.Us;return t.Ws.forEach(function(t,e){n.ti.set(t,e)}),e})},Ha);var $a=(Ya.prototype.next=function(){return this.ei+=2,this.ei},Ya.ni=function(){return new Ya(0)},Ya.si=function(){return new Ya(-1)},Ya),Xa=(Qa.prototype.ri=function(n){var r=this;return this.oi(n).next(function(t){var e=new $a(t.highestTargetId);return t.highestTargetId=e.next(),r.hi(n,t).next(function(){return t.highestTargetId})})},Qa.prototype.ai=function(t){return this.oi(t).next(function(t){return Xr.I(new $r(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Qa.prototype.ui=function(t){return this.oi(t).next(function(t){return t.highestListenSequenceNumber})},Qa.prototype.ci=function(e,n,r){var i=this;return this.oi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.hi(e,t)})},Qa.prototype.li=function(e,n){var r=this;return this._i(e,n).next(function(){return r.oi(e).next(function(t){return t.targetCount+=1,r.fi(n,t),r.hi(e,t)})})},Qa.prototype.di=function(t,e){return this._i(t,e)},Qa.prototype.wi=function(e,t){var n=this;return this.Ti(e,t.targetId).next(function(){return Ja(e).delete(t.targetId)}).next(function(){return n.oi(e)}).next(function(t){return Dr(0<t.targetCount),--t.targetCount,n.hi(e,t)})},Qa.prototype.Ei=function(r,i,o){var s=this,u=0,a=[];return Ja(r).Qs(function(t,e){var n=Ma(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wi(r,n)))}).next(function(){return ea.Sn(a)}).next(function(){return u})},Qa.prototype.pe=function(t,r){return Ja(t).Qs(function(t,e){var n=Ma(e);r(n)})},Qa.prototype.oi=function(t){return Za(t).get(Cc.key).next(function(t){return Dr(null!==t),t})},Qa.prototype.hi=function(t,e){return Za(t).put(Cc.key,e)},Qa.prototype._i=function(t,e){return Ja(t).put(ja(this.serializer,e))},Qa.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Qa.prototype.Ii=function(t){return this.oi(t).next(function(t){return t.targetCount})},Qa.prototype.mi=function(t,i){var e=di(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return Ja(t).Qs({range:n,index:Lc.queryTargetsIndexName},function(t,e,n){var r=Ma(e);vi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},Qa.prototype.Ai=function(n,t,r){var i=this,o=[],s=tc(n);return t.forEach(function(t){var e=wa(t.path);o.push(s.put(new Rc(r,e))),o.push(i.ii.Ri(n,r,t))}),ea.Sn(o)},Qa.prototype.Pi=function(n,t,r){var i=this,o=tc(n);return ea.forEach(t,function(t){var e=wa(t.path);return ea.Sn([o.delete([r,e]),i.ii.gi(n,r,t)])})},Qa.prototype.Ti=function(t,e){var n=tc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Qa.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=tc(t),o=zi();return r.Qs({range:n,yi:!0},function(t,e,n){var r=Ea(t[1]),i=new ti(r);o=o.add(i)}).next(function(){return o})},Qa.prototype.pi=function(t,e){var n=wa(e.path),r=IDBKeyRange.bound([n],[Cr(n)],!1,!0),i=0;return tc(t).Qs({index:Rc.documentTargetsIndex,yi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Qa.prototype.Me=function(t,e){return Ja(t).get(e).next(function(t){return t?Ma(t):null})},Qa);function Qa(t,e){this.ii=t,this.serializer=e}function Ya(t){this.ei=t}function Ja(t){return ic.Ns(t,Lc.store)}function Za(t){return ic.Ns(t,Cc.store)}function tc(t){return ic.Ns(t,Rc.store)}var ec,nc="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rc=(n(sc,ec=ia),sc),ic=(oc.Ns=function(t,e){if(t instanceof rc)return qc.Ns(t.bi,e);throw Sr()},oc.prototype.start=function(){var e=this;return qc.Ui(this.Li,bc,new Ic(this.serializer)).then(function(t){return e.Wi=t,e.Qi()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Hr(Kr.FAILED_PRECONDITION,nc);return e.ji(),e.Ki(),e.Gi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qi.ui(t)})}).then(function(t){e.Ci=new ua(t,e.Si)}).then(function(){e.Fi=!0}).catch(function(t){return e.Wi&&e.Wi.close(),Promise.reject(t)})},oc.prototype.zi=function(n){var t=this;return this.Mi=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.Hi?[2,n(e)]:[2]})})},n(this.isPrimary)},oc.prototype.Yi=function(n){var t=this;this.Wi.Ji(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},oc.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},oc.prototype.Qi=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ac(e).put(new Mc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tr(e).next(function(t){t||(n.isPrimary=!1,n.Ts.er(function(){return n.Mi(!1)}))})}).next(function(){return n.nr(e)}).next(function(t){return n.isPrimary&&!t?n.sr(e).next(function(){return!1}):!!t&&n.ir(e).next(function(){return!0})})}).catch(function(t){if(Hc(t))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Ts.er(function(){return n.Mi(t)}),n.isPrimary=t})},oc.prototype.tr=function(t){var e=this;return uc(t).get(Tc.key).next(function(t){return ea.resolve(e.rr(t))})},oc.prototype.or=function(t){return ac(t).delete(this.clientId)},oc.prototype.hr=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ar(this.xi,18e5)?[3,2]:(this.xi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=oc.Ns(t,Mc.store);return r.$s().next(function(t){var e=o.ur(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ea.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)i=r[n],this.Bi.removeItem(this.cr(i.clientId));t.label=2;case 2:return[2]}})})},oc.prototype.Gi=function(){var t=this;this.ki=this.Ts.bs("client_metadata_refresh",4e3,function(){return t.Qi().then(function(){return t.hr()}).then(function(){return t.Gi()})})},oc.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},oc.prototype.nr=function(e){var i=this;return this.Di?ea.resolve(!0):uc(e).get(Tc.key).next(function(t){if(null!==t&&i.ar(t.leaseTimestampMs,5e3)&&!i.lr(t.ownerId)){if(i.rr(t)&&i.networkEnabled)return!0;if(!i.rr(t)){if(!t.allowTabSynchronization)throw new Hr(Kr.FAILED_PRECONDITION,nc);return!1}}return!(!i.networkEnabled||!i.inForeground)||ac(e).$s().next(function(t){return void 0===i.ur(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},oc.prototype._r=function(){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Fi=!1,this.dr(),this.ki&&(this.ki.cancel(),this.ki=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.sr(t).next(function(){return e.or(t)})}).catch(function(t){Nr("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Wi.close(),this.Er(),[2]}})})},oc.prototype.ur=function(t,e){var n=this;return t.filter(function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)})},oc.prototype.Ir=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return ac(t).$s().next(function(t){return e.ur(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(oc.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),oc.prototype.mr=function(t){return pc.Ar(t,this.serializer,this.Kn,this.ii)},oc.prototype.Rr=function(){return this.qi},oc.prototype.Pr=function(){return this.Qn},oc.prototype.gr=function(){return this.Kn},oc.prototype.runTransaction=function(e,n,r){var i=this;Nr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wi.runTransaction(t,Fc,function(t){return o=new rc(t,i.Ci?i.Ci.next():ua.ws),"readwrite-primary"===n?i.tr(o).next(function(t){return!!t||i.nr(o)}).next(function(t){if(!t)throw Ar("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Ts.er(function(){return i.Mi(!1)}),new Hr(Kr.FAILED_PRECONDITION,ra);return r(o)}).next(function(t){return i.ir(o).next(function(){return t})}):i.Vr(o).next(function(){return r(o)})}).then(function(t){return o.Wn(),t})},oc.prototype.Vr=function(t){var e=this;return uc(t).get(Tc.key).next(function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Hr(Kr.FAILED_PRECONDITION,nc)})},oc.prototype.ir=function(t){var e=new Tc(this.clientId,this.allowTabSynchronization,Date.now());return uc(t).put(Tc.key,e)},oc.Oi=function(){return qc.Oi()},oc.prototype.sr=function(t){var e=this,n=uc(t);return n.get(Tc.key).next(function(t){return e.rr(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(Tc.key)):ea.resolve()})},oc.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},oc.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=function(){t.Ts.Zi(function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()})},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)},oc.prototype.wr=function(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)},oc.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.$i=function(){e.dr(),e.Ts.Zi(function(){return e._r()})},this.window.addEventListener("unload",this.$i))},oc.prototype.Tr=function(){this.$i&&(this.window.removeEventListener("unload",this.$i),this.$i=null)},oc.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},oc.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},oc.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},oc.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},oc);function oc(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Ts=i,this.window=o,this.document=s,this.Si=a,this.Di=c,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.$i=null,this.inForeground=!1,this.Ni=null,this.ki=null,this.xi=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!oc.Oi())throw new Hr(Kr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new cc(this,r),this.Li=e+"main",this.serializer=new ka(u),this.qi=new Xa(this.ii,this.serializer),this.Kn=new Aa,this.Qn=new qa(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===c&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function sc(t,e){var n=this;return(n=ec.call(this)||this).bi=t,n.vi=e,n}function uc(t){return ic.Ns(t,Tc.store)}function ac(t){return ic.Ns(t,Mc.store)}var cc=(hc.prototype.pr=function(t){var n=this.br(t);return this.db.Rr().Ii(t).next(function(e){return n.next(function(t){return e+t})})},hc.prototype.br=function(t){var e=0;return this.vr(t,function(t){e++}).next(function(){return e})},hc.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},hc.prototype.vr=function(t,n){return this.Sr(t,function(t,e){return n(e)})},hc.prototype.Ri=function(t,e,n){return fc(t,n)},hc.prototype.gi=function(t,e,n){return fc(t,n)},hc.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},hc.prototype.Dr=function(t,e){return fc(t,e)},hc.prototype.Cr=function(t,e){return r=e,i=!1,wc(n=t).Fr(function(t){return vc(n,t,r).next(function(t){return t&&(i=!0),ea.resolve(!t)})}).next(function(){return i});var n,r,i},hc.prototype.$r=function(r,i){var o=this,s=this.db.Pr().Hs(),u=[],a=0;return this.Sr(r,function(e,t){if(t<=i){var n=o.Cr(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.xn(e),tc(r).delete([0,wa(e.path)])})});u.push(n)}}).next(function(){return ea.Sn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},hc.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},hc.prototype.Nr=function(t,e){return fc(t,e)},hc.prototype.Sr=function(t,o){var s,e=tc(t),u=ua.ws;return e.Qs({index:Rc.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==ua.ws&&o(new ti(Ea(s)),u),u=i,s=r):u=ua.ws}).next(function(){u!==ua.ws&&o(new ti(Ea(s)),u)})},hc.prototype.kr=function(t){return this.db.Pr().Xs(t)},hc);function hc(t,e){this.db=t,this.yr=new dh(this,e)}function fc(t,e){return tc(t).put((n=e,r=t.vi,new Rc(0,wa(n.path),r)));var n,r}function lc(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var pc=(dc.Ar=function(t,e,n,r){return Dr(""!==t.uid),new dc(t.Mr()?t.uid:"",e,n,r)},dc.prototype.Or=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gc(t).Qs({index:_c.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},dc.prototype.Lr=function(c,h,f,l){var p=this,d=mc(c),v=gc(c);return v.add({}).next(function(t){Dr("number"==typeof t);for(var e=new Zu(t,h,f,l),n=function(e,t,n){var r=n.baseMutations.map(function(t){return Xo(e.ks,t)}),i=n.mutations.map(function(t){return Xo(e.ks,t)});return new _c(t,n.batchId,n.dn.toMillis(),r,i)}(p.serializer,p.userId,e),r=[],i=new Li(function(t,e){return Lr(t.$(),e.$())}),o=0,s=l;o<s.length;o++){var u=s[o],a=Sc.key(p.userId,u.key.path,t);i=i.add(u.key.path.p()),r.push(v.put(n)),r.push(d.put(a,Sc.PLACEHOLDER))}return i.forEach(function(t){r.push(p.Kn.Cs(c,t))}),c.Un(function(){p.xr[t]=e.keys()}),ea.Sn(r).next(function(){return e})})},dc.prototype.qr=function(t,e){var n=this;return gc(t).get(e).next(function(t){return t?(Dr(t.userId===n.userId),Ua(n.serializer,t)):null})},dc.prototype.Br=function(t,n){var r=this;return this.xr[n]?ea.resolve(this.xr[n]):this.qr(t,n).next(function(t){if(t){var e=t.keys();return r.xr[n]=e}return null})},dc.prototype.Ur=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return gc(t).Qs({index:_c.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Dr(e.batchId>=i),o=Ua(r.serializer,e)),n.done()}).next(function(){return o})},dc.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return gc(t).Qs({index:_c.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},dc.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gc(t).$s(_c.userMutationsIndex,n).next(function(t){return t.map(function(t){return Ua(e.serializer,t)})})},dc.prototype.zn=function(u,a){var c=this,t=Sc.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return mc(u).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Ea(i);if(r===c.userId&&a.path.isEqual(s))return gc(u).get(o).next(function(t){if(!t)throw Sr();Dr(t.userId===c.userId),h.push(Ua(c.serializer,t))});n.done()}).next(function(){return h})},dc.prototype.Zn=function(r,t){var a=this,c=new Li(Lr),i=[];return t.forEach(function(u){var t=Sc.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=mc(r).Qs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Ea(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),ea.Sn(i).next(function(){return a.jr(r,c)})},dc.prototype.os=function(t,e){var u=this,a=e.path,c=a.length+1,n=Sc.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new Li(Lr);return mc(t).Qs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Ea(i);r===u.userId&&a.D(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.jr(t,h)})},dc.prototype.jr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(gc(e).get(t).next(function(t){if(null===t)throw Sr();Dr(t.userId===n.userId),r.push(Ua(n.serializer,t))}))}),ea.Sn(i).next(function(){return r})},dc.prototype.Kr=function(e,n){var r=this;return yc(e.bi,this.userId,n).next(function(t){return e.Un(function(){r.Gr(n.batchId)}),ea.forEach(t,function(t){return r.ii.Dr(e,t)})})},dc.prototype.Gr=function(t){delete this.xr[t]},dc.prototype.zr=function(n){var o=this;return this.Or(n).next(function(t){if(!t)return ea.resolve();var e=IDBKeyRange.lowerBound(Sc.prefixForUser(o.userId)),i=[];return mc(n).Qs({range:e},function(t,e,n){if(t[0]===o.userId){var r=Ea(t[1]);i.push(r)}else n.done()}).next(function(){Dr(0===i.length)})})},dc.prototype.pi=function(t,e){return vc(t,this.userId,e)},dc.prototype.Hr=function(t){var e=this;return wc(t).get(this.userId).next(function(t){return t||new Ac(e.userId,-1,"")})},dc);function dc(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.xr={}}function vc(t,o,e){var n=Sc.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return mc(t).Qs({range:r,yi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function yc(t,e,n){var r=t.store(_c.store),i=t.store(Sc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Dr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Sc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ea.Sn(o).next(function(){return c})}function gc(t){return ic.Ns(t,_c.store)}function mc(t){return ic.Ns(t,Sc.store)}function wc(t){return ic.Ns(t,Ac.store)}var bc=10,Ic=(Nc.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Dr(t<e&&0<=t&&e<=bc);var o,s=new $c(r);t<1&&1<=e&&(n.createObjectStore(Tc.store),(o=n).createObjectStore(Ac.store,{keyPath:Ac.keyPath}),o.createObjectStore(_c.store,{keyPath:_c.keyPath,autoIncrement:!0}).createIndex(_c.userMutationsIndex,_c.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Sc.store),Uc(n),n.createObjectStore(Oc.store));var u,a=ea.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Rc.store),u.deleteObjectStore(Lc.store),u.deleteObjectStore(Cc.store),Uc(n)),a=a.next(function(){return t=s.store(Cc.store),e=new Cc(0,0,Xr.min().A(),0),t.put(Cc.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(_c.store).$s().next(function(t){r.deleteObjectStore(_c.store),r.createObjectStore(_c.store,{keyPath:_c.keyPath,autoIncrement:!0}).createIndex(_c.userMutationsIndex,_c.userMutationsKeyPath,{unique:!0});var e=i.store(_c.store),n=t.map(function(t){return e.put(t)});return ea.Sn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Mc.store,{keyPath:Mc.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Pc.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Oc.store)).createIndex(Oc.readTimeIndex,Oc.readTimeIndexPath,{unique:!1}),t.createIndex(Oc.collectionReadTimeIndex,Oc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Nc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Oc.store).Qs(function(t,e){n+=Ka(e)}).next(function(){var t=new Pc(n);return e.store(Pc.store).put(Pc.key,t)})},Nc.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Ac.store),e=r.store(_c.store);return t.$s().next(function(t){return ea.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.$s(_c.userMutationsIndex,t).next(function(t){return ea.forEach(t,function(t){Dr(t.userId===n.userId);var e=Ua(i.serializer,t);return yc(r,n.userId,e).next(function(){})})})})})},Nc.prototype.ensureSequenceNumbers=function(t){var s=t.store(Rc.store),e=t.store(Oc.store);return t.store(Cc.store).get(Cc.key).next(function(i){var o=[];return e.Qs(function(t,e){var n=new Yr(t),r=[0,wa(n)];o.push(s.get(r).next(function(t){return t?ea.resolve():(e=n,s.put(new Rc(0,wa(e),i.highestListenSequenceNumber)));var e}))}).next(function(){return ea.Sn(o)})})},Nc.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:wa(n)})}}t.createObjectStore(Vc.store,{keyPath:Vc.keyPath});var r=e.store(Vc.store),o=new Na;return e.store(Oc.store).Qs({yi:!0},function(t,e){var n=new Yr(t);return i(n.p())}).next(function(){return e.store(Sc.store).Qs({yi:!0},function(t,e){t[0];var n=t[1],r=(t[2],Ea(n));return i(r.p())})})},Nc.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Lc.store);return o.Qs(function(t,e){var n=Ma(e),r=ja(i.serializer,n);return o.put(r)})},Nc),Ec=function(t,e){this.seconds=t,this.nanoseconds=e},Tc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Nc(t){this.serializer=t}Tc.store="owner",Tc.key="owner";var Ac=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ac.store="mutationQueues",Ac.keyPath="userId";var _c=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};_c.store="mutations",_c.keyPath="batchId",_c.userMutationsIndex="userMutationsIndex",_c.userMutationsKeyPath=["userId","batchId"];var Sc=(Dc.prefixForUser=function(t){return[t]},Dc.prefixForPath=function(t,e){return[t,wa(e)]},Dc.key=function(t,e,n){return[t,wa(e),n]},Dc);function Dc(){}Sc.store="documentMutations",Sc.PLACEHOLDER=new Sc;var xc=function(t,e){this.path=t,this.readTime=e},kc=function(t,e){this.path=t,this.version=e},Oc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Oc.store="remoteDocuments",Oc.readTimeIndex="readTimeIndex",Oc.readTimeIndexPath="readTime",Oc.collectionReadTimeIndex="collectionReadTimeIndex",Oc.collectionReadTimeIndexPath=["parentPath","readTime"];var Pc=function(t){this.byteSize=t};Pc.store="remoteDocumentGlobal",Pc.key="remoteDocumentGlobalKey";var Lc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Lc.store="targets",Lc.keyPath="targetId",Lc.queryTargetsIndexName="queryTargetsIndex",Lc.queryTargetsKeyPath=["canonicalId","targetId"];var Rc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Rc.store="targetDocuments",Rc.keyPath=["targetId","path"],Rc.documentTargetsIndex="documentTargetsIndex",Rc.documentTargetsKeyPath=["path","targetId"];var Cc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Cc.key="targetGlobalKey",Cc.store="targetGlobal";var Vc=function(t,e){this.collectionId=t,this.parent=e};function Uc(t){t.createObjectStore(Rc.store,{keyPath:Rc.keyPath}).createIndex(Rc.documentTargetsIndex,Rc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Lc.store,{keyPath:Lc.keyPath}).createIndex(Lc.queryTargetsIndexName,Lc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Cc.store)}Vc.store="collectionParents",Vc.keyPath=["collectionId","parent"];var Mc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Mc.store="clientMetadata",Mc.keyPath="clientId";var jc,Fc=d(d(d([Ac.store,_c.store,Sc.store,Oc.store,Lc.store,Tc.store,Cc.store,Rc.store],[Mc.store]),[Pc.store]),[Vc.store]),qc=(Kc.Ui=function(o,t,s){return Nr("SimpleDb","Opening database:",o),new ea(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Kc(e))},i.onblocked=function(){r(new Hr(Kr.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Hr(Kr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,bc).next(function(){Nr("SimpleDb","Database upgrade to version "+bc+" complete")})}}).bn()},Kc.delete=function(t){return Nr("SimpleDb","Removing database:",t),Jc(window.indexedDB.deleteDatabase(t)).bn()},Kc.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(Kc.Jr())return!0;var t=v(),e=Kc.Yr(t),n=0<e&&e<10,r=Kc.Xr(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Kc.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},Kc.Ns=function(t,e){return t.store(e)},Kc.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Kc.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Kc.prototype.Ji=function(e){this.db.onversionchange=function(t){return e(t)}},Kc.prototype.runTransaction=function(r,c,h){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,e=$c.open(a.db,s?"readonly":"readwrite",c),t.label=1;case 1:return t.trys.push([1,3,,4]),n=h(e).catch(function(t){return e.abort(t),ea.reject(t)}).bn(),r={},n.catch(function(){}),[4,e.to];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Nr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Kc.prototype.close=function(){this.db.close()},Kc),Gc=(Object.defineProperty(Wc.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(Wc.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(Wc.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Wc.prototype.done=function(){this.no=!0},Wc.prototype.js=function(t){this.so=t},Wc.prototype.delete=function(){return Jc(this.eo.delete())},Wc),Bc=(n(zc,jc=Hr),zc);function zc(t){var e=this;return(e=jc.call(this,Kr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Wc(t){this.eo=t,this.no=!1,this.so=null}function Kc(t){this.db=t,12.2===Kc.Yr(v())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Hc(t){return"IndexedDbTransactionError"===t.name}var $c=(Yc.open=function(t,e,n){return new Yc(t.transaction(n,e))},Object.defineProperty(Yc.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),Yc.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Yc.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Xc(e)},Yc),Xc=(Qc.prototype.put=function(t,e){return Jc(void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Qc.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),Jc(this.store.add(t))},Qc.prototype.get=function(e){var n=this;return Jc(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Nr("SimpleDb","GET",n.store.name,e,t),t})},Qc.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),Jc(this.store.delete(t))},Qc.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),Jc(this.store.count())},Qc.prototype.$s=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,function(t,e){r.push(e)}).next(function(){return r})},Qc.prototype.ho=function(t,e){Nr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,function(t,e,n){return n.delete()})},Qc.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},Qc.prototype.Fr=function(i){var t=this.cursor({});return new ea(function(n,r){t.onerror=function(t){var e=th(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Qc.prototype.oo=function(t,s){var u=[];return new ea(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e=t.target.result;if(e){var n=new Gc(e),r=s(e.primaryKey,e.value,n);if(r instanceof ea){var i=r.catch(function(t){return n.done(),ea.reject(t)});u.push(i)}n.gn?o():null===n.io?e.continue():e.continue(n.io)}else o()}}).next(function(){return ea.Sn(u)})},Qc.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Qc.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Qc);function Qc(t){this.store=t}function Yc(t){var n=this;this.transaction=t,this.aborted=!1,this.ro=new ya,this.transaction.oncomplete=function(){n.ro.resolve()},this.transaction.onabort=function(){t.error?n.ro.reject(new Bc(t.error)):n.ro.resolve()},this.transaction.onerror=function(t){var e=th(t.target.error);n.ro.reject(new Bc(e))}}function Jc(t){return new ea(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=th(t.target.error);r(e)}})}var Zc=!1;function th(t){var e=qc.Yr(v());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Hr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Zc||(Zc=!0,setTimeout(function(){throw r},0)),r}}return t}function eh(){return"undefined"!=typeof window?window:null}var nh=(oh._o=function(t,e,n,r,i){var o=new oh(t,e,Date.now()+n,r,i);return o.start(n),o},oh.prototype.start=function(t){var e=this;this.fo=setTimeout(function(){return e.do()},t)},oh.prototype.Ss=function(){return this.do()},oh.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new Hr(Kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},oh.prototype.do=function(){var e=this;this.ao.Zi(function(){return null!==e.fo?(e.clearTimeout(),e.op().then(function(t){return e.lo.resolve(t)})):Promise.resolve()})},oh.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},oh),rh=(Object.defineProperty(ih.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),ih.prototype.Zi=function(t){this.enqueue(t)},ih.prototype.po=function(t){this.bo(),this.vo(t)},ih.prototype.So=function(t){return this.bo(),this.vo(t)},ih.prototype.Do=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=eh())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ih.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise(function(t){}):this.vo(t)},ih.prototype.er=function(t){var e=this;this.To.push(t),this.Zi(function(){return e.Co()})},ih.prototype.Co=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.To.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return t.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!Hc(e=t.sent()))throw e;return Nr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.To.length&&this.Po.ys(function(){return n.Co()}),t.label=5;case 5:return[2]}})})},ih.prototype.vo=function(t){var r=this,e=this.wo.then(function(){return r.Ao=!0,t().catch(function(t){throw r.mo=t,r.Ao=!1,Ar("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ao=!1,t})});return this.wo=e},ih.prototype.bs=function(t,e,n){var r=this;this.bo(),-1<this.Ro.indexOf(t)&&(e=0);var i=nh._o(this,t,e,n,function(t){return r.Fo(t)});return this.Io.push(i),i},ih.prototype.bo=function(){this.mo&&Sr()},ih.prototype.$o=function(){},ih.prototype.No=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.wo];case 1:t.sent(),t.label=2;case 2:if(e!==this.wo)return[3,0];t.label=3;case 3:return[2]}})})},ih.prototype.ko=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},ih.prototype.xo=function(r){var i=this;return this.No().then(function(){i.Io.sort(function(t,e){return t.uo-e.uo});for(var t=0,e=i.Io;t<e.length;t++){var n=e[t];if(n.Ss(),"all"!==r&&n.Es===r)break}return i.No()})},ih.prototype.Mo=function(t){this.Ro.push(t)},ih.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},ih);function ih(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new ga(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=eh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}function oh(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new ya,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch(function(t){})}function sh(t,e){if(Ar("AsyncQueue",e+": "+t),Hc(t))return new Hr(Kr.UNAVAILABLE,e+": "+t);throw t}function uh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Lr(n,i);return 0===s?Lr(r,o):s}var ah=(lh.prototype.qo=function(){return++this.Lo},lh.prototype.Bo=function(t){var e=[t,this.qo()];if(this.buffer.size<this.Oo)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();uh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(lh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),lh),ch={Uo:!1,Wo:0,Qo:0,jo:0},hh=(fh.Ho=function(t){return new fh(t,fh.Yo,fh.Jo)},fh);function fh(t,e,n){this.Ko=t,this.Go=e,this.zo=n}function lh(t){this.Oo=t,this.buffer=new Li(uh),this.Lo=0}hh.Xo=-1,hh.Zo=1048576,hh.th=41943040,hh.Yo=10,hh.Jo=1e3,hh.eh=new hh(hh.th,hh.Yo,hh.Jo),hh.nh=new hh(hh.Xo,0,0);var ph=(mh.prototype.start=function(t){this.yr.params.Ko!==hh.Xo&&this.rh(t)},mh.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(mh.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),mh.prototype.rh=function(n){var t=this,e=this.sh?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ih=this.ao.bs("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.ih=null,this.sh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.oh(this.yr)];case 2:return t.sent(),[3,7];case 3:return Hc(e=t.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ih(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.rh(n)];case 8:return t.sent(),[2]}})})})},mh),dh=(gh.prototype.ah=function(t,e){return this.hh.pr(t).next(function(t){return Math.floor(e/100*t)})},gh.prototype.uh=function(t,e){var n=this;if(0===e)return ea.resolve(ua.ws);var r=new ah(e);return this.hh.pe(t,function(t){return r.Bo(t.sequenceNumber)}).next(function(){return n.hh.vr(t,function(t){return r.Bo(t)})}).next(function(){return r.maxValue})},gh.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},gh.prototype.$r=function(t,e){return this.hh.$r(t,e)},gh.prototype.lh=function(e,n){var r=this;return this.params.Ko===hh.Xo?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),ea.resolve(ch)):this.kr(e).next(function(t){return t<r.params.Ko?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Ko),ch):r._h(e,n)})},gh.prototype.kr=function(t){return this.hh.kr(t)},gh.prototype._h=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.ah(e,this.params.Go).next(function(t){return i=t>h.params.zo?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.zo+" from "+t),h.params.zo):t,s=Date.now(),h.uh(e,i)}).next(function(t){return r=t,u=Date.now(),h.Ei(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.$r(e,r)}).next(function(t){return c=Date.now(),Tr()<=p.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ea.resolve({Uo:!0,Wo:i,Qo:o,jo:t})})},gh),vh=(yh.prototype.Ah=function(i){return g(this,void 0,void 0,function(){var e,m,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(y){var g;return r.jn.Qr(y).next(function(t){return g=t,e=r.persistence.mr(i),m=new oa(r.Eh,e,r.persistence.gr()),e.Qr(y)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var c=a[u];r=r.add(c.key)}}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Jn(y,r).next(function(t){return{Rh:t,Ph:e,gh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.Ih=m,this.fh.mh(this.Ih),n)]}})})},yh.prototype.Vh=function(c){var h,f=this,l=$r.now(),t=c.reduce(function(t,e){return t.add(e.key)},zi());return this.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Ih.Jn(a,t).next(function(t){h=t;for(var e=[],n=0,r=c;n<r.length;n++){var i=r[n],o=(u=i,s=h.get(i.key),u instanceof Gs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof uu?t.field(i.field):void 0,s=os(i.transform,o||null);null!=s&&(e=null==e?(new Ys).set(i.field,s):e.set(i.field,s))}return e?e.Ge():null}(s):null);null!=o&&e.push(new Us(i.key,o,nu(o.proto.mapValue),_s.exists(!0)))}var u,s;return f.jn.Lr(a,l,e,c)})}).then(function(t){var e=t.In(h);return{batchId:t.batchId,Cn:e}})},yh.prototype.yh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Eh.Hs({Js:!0});return i.ph(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.jn.zr(t)}).next(function(){return i.Ih.Jn(t,e)})})},yh.prototype.bh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.jn.qr(e,t).next(function(t){return Dr(null!==t),n=t.keys(),r.jn.Kr(e,t)}).next(function(){return r.jn.zr(e)}).next(function(){return r.Ih.Jn(e,n)})})},yh.prototype.Wr=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Wr(t)})},yh.prototype.ai=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qi.ai(t)})},yh.prototype.vh=function(a){var c=this,h=a.X,f=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=c.Eh.Hs({Js:!0});f=c.dh;var s=[];a.Wt.forEach(function(t,e){var n=f.get(e);if(n){s.push(c.qi.Pi(o,t.Xt,e).next(function(){return c.qi.Ai(o,t.Yt,e)}));var r=t.resumeToken;if(0<r.H()){var i=n.tt(r,h).Z(o.vi);f=f.nt(e,i),yh.Sh(n,i,t)&&s.push(c.qi.di(o,i))}}});var u=Mi(),n=zi();if(a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof au&&e.version.isEqual(Xr.min())?(i.xn(t,h),u=u.nt(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.Nn(e,h),u=u.nt(t,e)):Nr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(c.persistence.ii.Nr(o,t))})})),!h.isEqual(Xr.min())){var t=c.qi.ai(o).next(function(t){return c.qi.ci(o,o.vi,h)});s.push(t)}return ea.Sn(s).next(function(){return i.apply(o)}).next(function(){return c.Ih.Xn(o,u)})}).then(function(t){return c.dh=f,t})},yh.Sh=function(t,e,n){return Dr(0<e.resumeToken.H()),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||0<n.Yt.size+n.Jt.size+n.Xt.size},yh.prototype.Ch=function(h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ea.forEach(h,function(e){return ea.forEach(e.as,function(t){return c.persistence.ii.Ri(n,e.targetId,t)}).next(function(){return ea.forEach(e.us,function(t){return c.persistence.ii.gi(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Hc(e=t.sent()))throw e;return Nr("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=h;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.dh.get(o),u=s.X,a=s.et(u),this.dh=this.dh.nt(o,a));return[2]}})})},yh.prototype.Fh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.Ur(t,e)})},yh.prototype.$h=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Gn(t,e)})},yh.prototype.Nh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qi.mi(e,r).next(function(t){return t?(n=t,ea.resolve(n)):i.qi.ri(e).next(function(t){return n=new Ei(r,t,0,e.vi),i.qi.li(e,n).next(function(){return n})})})}).then(function(t){var e=i.dh.get(t.targetId);return(null===e||0<t.X.o(e.X))&&(i.dh=i.dh.nt(t.targetId,t),i.wh.set(r,t.targetId)),t})},yh.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?ea.resolve(this.dh.get(n)):this.qi.mi(t,e)},yh.prototype.kh=function(o,s){return g(this,void 0,void 0,function(){var e,n,r,i=this;return w(this,function(t){switch(t.label){case 0:e=this.dh.get(o),n=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,this.persistence.runTransaction("Release target",n,function(t){return i.persistence.ii.removeTarget(t,e)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Hc(r=t.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return this.dh=this.dh.remove(o),this.wh.delete(e.target),[2]}})})},yh.prototype.xh=function(t,n){var r=this,i=Xr.min(),o=zi();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.mi(e,bu(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qi.Vi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.fh.ts(e,t,n?i:Xr.min(),n?o:zi())}).next(function(t){return{documents:t,Mh:o}})})},yh.prototype.ph=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=ea.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.An.get(r);Dr(null!==n),(!e||e.version.o(n)<0)&&(e=s.wn(r,e,i))&&o.Nn(e,i.mn)})}),u.next(function(){return e.jn.Kr(t,s)})},yh.prototype.oh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.lh(t,n.dh)})},yh);function yh(t,e,n){this.persistence=t,this.fh=e,this.dh=new _i(Lr),this.wh=new Wr(function(t){return di(t)},vi),this.Th=Xr.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new oa(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}function gh(t,e){this.hh=t,this.params=e}function mh(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}function wh(t,e,n){return new vh(t,e,n)}function bh(t,e){var n=xr(t),r=xr(n.qi),i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Ih(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Kr.FAILED_PRECONDITION||e.message!==ra)throw e;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}vh.Dh=3e8;var Eh=(Ah.prototype._=function(){return this.Oh._()},Ah.prototype.Ri=function(t,e){var n=new Th(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},Ah.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Ri(t,e)})},Ah.prototype.gi=function(t,e){this.Wh(new Th(t,e))},Ah.prototype.Qh=function(t,e){var n=this;t.forEach(function(t){return n.gi(t,e)})},Ah.prototype.jh=function(t){var e=this,n=new ti(new Yr([])),r=new Th(n,t),i=new Th(n,t+1),o=[];return this.qh.vt([r,i],function(t){e.Wh(t),o.push(t.key)}),o},Ah.prototype.Kh=function(){var e=this;this.Oh.forEach(function(t){return e.Wh(t)})},Ah.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},Ah.prototype.Gh=function(t){var e=new ti(new Yr([])),n=new Th(e,t),r=new Th(e,t+1),i=zi();return this.qh.vt([n,r],function(t){i=i.add(t.key)}),i},Ah.prototype.pi=function(t){var e=new Th(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},Ah),Th=(Nh.Lh=function(t,e){return ti.P(t.key,e.key)||Lr(t.zh,e.zh)},Nh.Bh=function(t,e){return Lr(t.zh,e.zh)||ti.P(t.key,e.key)},Nh);function Nh(t,e){this.key=t,this.zh=e}function Ah(){this.Oh=new Li(Th.Lh),this.qh=new Li(Th.Bh)}function _h(t,e){if(0!==e.length)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+zh(e.length,"argument")+".")}function Sh(t,e,n){if(e.length!==n)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires "+zh(n,"argument")+", but was called with "+zh(e.length,"argument")+".")}function Dh(t,e,n){if(e.length<n)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+zh(n,"argument")+", but was called with "+zh(e.length,"argument")+".")}function xh(t,e,n,r){if(e.length<n||e.length>r)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+zh(e.length,"argument")+".")}function kh(t,e,n,r){Vh(t,e,Bh(n)+" argument",r)}function Oh(t,e,n,r){void 0!==r&&kh(t,e,n,r)}function Ph(t,e,n,r){Vh(t,e,n+" option",r)}function Lh(t,e,n,r){void 0!==r&&Ph(t,e,n,r)}function Rh(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Mh(s))}var u=Mh(n);throw new Hr(Kr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Ch(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid value "+Mh(r)+" provided to function "+t+"() for its "+Bh(n)+" argument. Acceptable values: "+e.join(", "));return r}function Vh(t,e,n,r){if(!("object"===e?Uh(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Mh(r);throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Uh(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Mh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Sr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function jh(t,e,n){if(void 0===n)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Bh(e)+" argument, but it was undefined.")}function Fh(n,t,r){Fr(t,function(t,e){if(r.indexOf(t)<0)throw new Hr(Kr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function qh(t,e,n,r){var i=Mh(r);return new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Bh(n)+" argument to be a "+e+", but it was: "+i)}function Gh(t,e,n){if(n<=0)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Bh(e)+" argument to be a positive number, but it was: "+n+".")}function Bh(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function zh(t,e){return t+" "+e+(1===t?"":"s")}function Wh(){if("undefined"==typeof Uint8Array)throw new Hr(Kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Kh(){if("undefined"==typeof atob)throw new Hr(Kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Hh,$h,Xh=(rf.fromBase64String=function(t){Sh("Blob.fromBase64String",arguments,1),kh("Blob.fromBase64String","string",1,t),Kh();try{return new rf(gi.fromBase64String(t))}catch(t){throw new Hr(Kr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},rf.fromUint8Array=function(t){if(Sh("Blob.fromUint8Array",arguments,1),Wh(),!(t instanceof Uint8Array))throw qh("Blob.fromUint8Array","Uint8Array",1,t);return new rf(gi.fromUint8Array(t))},rf.prototype.toBase64=function(){return Sh("Blob.toBase64",arguments,0),Kh(),this.Hh.toBase64()},rf.prototype.toUint8Array=function(){return Sh("Blob.toUint8Array",arguments,0),Wh(),this.Hh.toUint8Array()},rf.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},rf.prototype.isEqual=function(t){return this.Hh.isEqual(t.Hh)},rf),Qh=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Hr(Kr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(kh("FieldPath","string",e,t[e]),0===t[e].length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yh=new Zr(t)},Yh=(n(nf,$h=Qh),nf.documentId=function(){return new nf(Zr.L().$())},nf.prototype.isEqual=function(t){if(!(t instanceof nf))throw qh("isEqual","FieldPath",1,t);return this.Yh.isEqual(t.Yh)},nf),Jh=new RegExp("[~\\*/\\[\\]]"),Zh=function(){this.Jh=this},tf=(n(ef,Hh=Zh),ef.prototype.Zh=function(t){if(2!==t.ta)throw 1===t.ta?t.ea(this.Xh+"() can only appear at the top level of your update data"):t.ea(this.Xh+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},ef.prototype.isEqual=function(t){return t instanceof ef},ef);function ef(t){var e=this;return(e=Hh.call(this)||this).Xh=t,e}function nf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return $h.call(this,t)||this}function rf(t){Kh(),this.Hh=t}function of(t,e,n){return new Rf({ta:3,na:e.settings.na,methodName:t.Xh,sa:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var sf,uf,af,cf,hf,ff,lf=(n(Af,ff=Zh),Af.prototype.Zh=function(t){return new Ts(t.path,new as)},Af.prototype.isEqual=function(t){return t instanceof Af},Af),pf=(n(Nf,hf=Zh),Nf.prototype.Zh=function(t){var e=of(this,t,!0),n=this.ia.map(function(t){return Gf(t,e)}),r=new cs(n);return new Ts(t.path,r)},Nf.prototype.isEqual=function(t){return this===t},Nf),df=(n(Tf,cf=Zh),Tf.prototype.Zh=function(t){var e=of(this,t,!0),n=this.ia.map(function(t){return Gf(t,e)}),r=new ds(n);return new Ts(t.path,r)},Tf.prototype.isEqual=function(t){return this===t},Tf),vf=(n(Ef,af=Zh),Ef.prototype.Zh=function(t){var e=new ms(t.serializer,Vo(t.serializer,this.ra));return new Ts(t.path,e)},Ef.prototype.isEqual=function(t){return this===t},Ef),yf=(n(If,uf=Zh),If.delete=function(){return _h("FieldValue.delete",arguments),new gf(new tf("FieldValue.delete"))},If.serverTimestamp=function(){return _h("FieldValue.serverTimestamp",arguments),new gf(new lf("FieldValue.serverTimestamp"))},If.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dh("FieldValue.arrayUnion",arguments,1),new gf(new pf("FieldValue.arrayUnion",t))},If.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dh("FieldValue.arrayRemove",arguments,1),new gf(new df("FieldValue.arrayRemove",t))},If.increment=function(t){return kh("FieldValue.increment","number",1,t),Sh("FieldValue.increment",arguments,1),new gf(new vf("FieldValue.increment",t))},If),gf=(n(bf,sf=yf),bf.prototype.Zh=function(t){return this.Jh.Zh(t)},bf.prototype.isEqual=function(t){return t instanceof bf&&this.Jh.isEqual(t.Jh)},bf),mf=(Object.defineProperty(wf.prototype,"latitude",{get:function(){return this.oa},enumerable:!1,configurable:!0}),Object.defineProperty(wf.prototype,"longitude",{get:function(){return this.ha},enumerable:!1,configurable:!0}),wf.prototype.isEqual=function(t){return this.oa===t.oa&&this.ha===t.ha},wf.prototype.T=function(t){return Lr(this.oa,t.oa)||Lr(this.ha,t.ha)},wf);function wf(t,e){if(Sh("GeoPoint",arguments,2),kh("GeoPoint","number",1,t),kh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Hr(Kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Hr(Kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.oa=t,this.ha=e}function bf(t){var e=this;return(e=sf.call(this)||this).Jh=t,e.Xh=t.Xh,e}function If(){return uf.call(this)||this}function Ef(t,e){var n=this;return(n=af.call(this)||this).Xh=t,n.ra=e,n}function Tf(t,e){var n=this;return(n=cf.call(this)||this).Xh=t,n.ia=e,n}function Nf(t,e){var n=this;return(n=hf.call(this)||this).Xh=t,n.ia=e,n}function Af(t){var e=this;return(e=ff.call(this)||this).Xh=t,e}function _f(t){return new Lo(t,!0)}var Sf=/^__.*__$/,Df=function(t,e,n){this.aa=t,this.ua=e,this.ca=n},xf=(Pf.prototype.la=function(t,e){var n=[];return null!==this.Le?n.push(new Us(t,this.data,this.Le,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Pf),kf=(Of.prototype.la=function(t,e){var n=[new Us(t,this.data,this.Le,e)];return 0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},Of);function Of(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Pf(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}function Lf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Sr()}}var Rf=(Object.defineProperty(Uf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Uf.prototype,"ta",{get:function(){return this.settings.ta},enumerable:!1,configurable:!0}),Uf.prototype.fa=function(t){return new Uf(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},Uf.prototype.da=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r.wa(t),r},Uf.prototype.Ta=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r._a(),r},Uf.prototype.Ea=function(t){return this.fa({path:void 0,sa:!0})},Uf.prototype.ea=function(t){return $f(t,this.settings.methodName,this.settings.Ia||!1,this.path,this.settings.na)},Uf.prototype.contains=function(e){return void 0!==this.Le.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},Uf.prototype._a=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},Uf.prototype.wa=function(t){if(0===t.length)throw this.ea("Document fields must not be empty");if(Lf(this.ta)&&Sf.test(t))throw this.ea('Document fields cannot begin and end with "__"')},Uf),Cf=(Vf.prototype.ma=function(t,e,n,r){return void 0===r&&(r=!1),new Rf({ta:t,methodName:e,na:n,path:Zr.k(),sa:!1,Ia:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Vf);function Vf(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||_f(t)}function Uf(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this._a(),this.fieldTransforms=i||[],this.Le=o||[]}function Mf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ma(o.merge||o.mergeFields?2:0,e,n,i);Wf("Data must be an object, but it was:",s,r);var u,a,c=Bf(r,s);if(o.merge)u=new Es(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Qh)d=p.Yh;else{if("string"!=typeof p)throw Sr();d=Hf(e,p,n)}if(!s.contains(d))throw new Hr(Kr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Xf(h,d)||h.push(d)}u=new Es(h),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new xf(new Qs(c),u,a)}function jf(t,o,s,e){var u=t.ma(1,o,s);Wf("Data must be an object, but it was:",u,e);var a=[],c=new Ys;Fr(e,function(t,e){var n=Hf(o,t,s),r=u.Ta(n);if(e instanceof Zh&&e.Jh instanceof tf)a.push(n);else{var i=Gf(e,r);null!=i&&(a.push(n),c.set(n,i))}});var n=new Es(a);return new kf(c.Ge(),n,u.fieldTransforms)}function Ff(t,e,n,r,i,o){var s=t.ma(1,e,n),u=[Kf(e,r,n)],a=[i];if(o.length%2!=0)throw new Hr(Kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Kf(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ys,l=u.length-1;0<=l;--l)if(!Xf(h,u[l])){var p=u[l],d=a[l],v=s.Ta(p);if(d instanceof Zh&&d.Jh instanceof tf)h.push(p);else{var y=Gf(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new Es(h);return new kf(f.Ge(),g,s.fieldTransforms)}function qf(t,e,n,r){return void 0===r&&(r=!1),Gf(n,t.ma(r?4:3,e))}function Gf(s,t){if(zf(s))return Wf("Unsupported field value:",t,s),Bf(s,t);if(s instanceof Zh)return function(t,e){if(!Lf(e.ta))throw e.ea(t.Xh+"() can only be used with update() and set()");if(!e.path)throw e.ea(t.Xh+"() is not currently supported inside arrays");var n=t.Zh(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Le.push(t.path),s instanceof Array){if(t.settings.sa&&4!==t.ta)throw t.ea("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Gf(i[r],t.Ea(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=$r.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof $r){var r=new $r(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof mf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Xh)return{bytesValue:Mo(e.serializer,t)};if(t instanceof Df){var i=e.s,o=t.aa;if(!o.isEqual(i))throw e.ea("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Fo(t.aa||e.s,t.ua.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ea("Unsupported field value: "+Mh(t))}(s,t)}function Bf(t,r){var i={};return qr(t)?r.path&&0<r.path.length&&r.Le.push(r.path):Fr(t,function(t,e){var n=Gf(e,r.da(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function zf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof $r||t instanceof mf||t instanceof Xh||t instanceof Df||t instanceof Zh)}function Wf(t,e,n){if(!zf(n)||!Uh(n)){var r=Mh(n);throw"an object"===r?e.ea(t+" a custom object"):e.ea(t+" "+r)}}function Kf(t,e,n){if(e instanceof Qh)return e.Yh;if("string"==typeof e)return Hf(t,e);throw $f("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Hf(t,e,n){try{return function(e){if(0<=e.search(Jh))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Yh.bind.apply(Yh,d([void 0],e.split("."))))}catch(t){throw new Hr(Kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yh}catch(e){throw $f(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function $f(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Hr(Kr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Xf(t,e){return t.some(function(t){return t.isEqual(e)})}var Qf=(Yf.prototype.Mr=function(){return null!=this.uid},Yf.prototype.Aa=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},Yf.prototype.isEqual=function(t){return t.uid===this.uid},Yf);function Yf(t){this.uid=t}Qf.UNAUTHENTICATED=new Qf(null),Qf.Ra=new Qf("google-credentials-uid"),Qf.Pa=new Qf("first-party-uid");function Jf(t,e){this.user=e,this.type="OAuth",this.ga={},this.ga.Authorization="Bearer "+t}var Zf,tl,el,nl=(Tl.prototype.getToken=function(){return Promise.resolve(null)},Tl.prototype.ya=function(){},Tl.prototype.pa=function(t){(this.Va=t)(Qf.UNAUTHENTICATED)},Tl.prototype.ba=function(){this.Va=null},Tl),rl=(El.prototype.getToken=function(){var e=this,n=this.Da,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Da!==n?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Dr("string"==typeof t.accessToken),new Jf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},El.prototype.ya=function(){this.forceRefresh=!0},El.prototype.pa=function(t){this.Va=t,this.Sa&&t(this.currentUser)},El.prototype.ba=function(){this.auth&&this.auth.removeAuthTokenListener(this.va),this.va=null,this.Va=null},El.prototype.Ca=function(){var t=this.auth&&this.auth.getUid();return Dr(null===t||"string"==typeof t),new Qf(t)},El),il=(Object.defineProperty(Il.prototype,"ga",{get:function(){var t={"X-Goog-AuthUser":this.$a},e=this.Fa.auth.Na([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Il),ol=(bl.prototype.getToken=function(){return Promise.resolve(new il(this.Fa,this.$a))},bl.prototype.pa=function(t){t(Qf.Pa)},bl.prototype.ba=function(){},bl.prototype.ya=function(){},bl),sl=(wl.prototype.qa=function(){return 1===this.state||2===this.state||4===this.state},wl.prototype.Ba=function(){return 2===this.state},wl.prototype.start=function(){3!==this.state?this.auth():this.Ua()},wl.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},wl.prototype.Wa=function(){this.state=0,this.Po.reset()},wl.prototype.Qa=function(){var t=this;this.Ba()&&null===this.La&&(this.La=this.Ts.bs(this.ka,6e4,function(){return t.ja()}))},wl.prototype.Ka=function(t){this.Ga(),this.stream.send(t)},wl.prototype.ja=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Ba()?[2,this.close(0)]:[2]})})},wl.prototype.Ga=function(){this.La&&(this.La.cancel(),this.La=null)},wl.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga(),this.Po.cancel(),this.Oa++,3!==e?this.Po.reset():n&&n.code===Kr.RESOURCE_EXHAUSTED?(Ar(n.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):n&&n.code===Kr.UNAUTHENTICATED&&this.Ma.ya(),null!==this.stream&&(this.za(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ha(n)];case 1:return t.sent(),[2]}})})},wl.prototype.za=function(){},wl.prototype.auth=function(){var n=this;this.state=1;var t=this.Ya(this.Oa),e=this.Oa;this.Ma.getToken().then(function(t){n.Oa===e&&n.Ja(t)},function(e){t(function(){var t=new Hr(Kr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Xa(t)})})},wl.prototype.Ja=function(t){var e=this,n=this.Ya(this.Oa);this.stream=this.Za(t),this.stream.tu(function(){n(function(){return e.state=2,e.listener.tu()})}),this.stream.Ha(function(t){n(function(){return e.Xa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},wl.prototype.Ua=function(){var t=this;this.state=4,this.Po.ys(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},wl.prototype.Xa=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},wl.prototype.Ya=function(e){var n=this;return function(t){n.Ts.Zi(function(){return n.Oa===e?t():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},wl),ul=(n(ml,el=sl),ml.prototype.Za=function(t){return this.xa.eu("Listen",t)},ml.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n,r,i,o,s,u;if("targetChange"in e){e.targetChange;var a="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Sr(),c=e.targetChange.targetIds||[],h=(o=t,s=e.targetChange.resumeToken,o.Oe?(Dr(void 0===s||"string"==typeof s),gi.fromBase64String(s||"")):(Dr(void 0===s||s instanceof Uint8Array),gi.fromUint8Array(s||new Uint8Array))),f=e.targetChange.cause,l=f&&(i=void 0===(r=f).code?Kr.UNKNOWN:Ai(r.code),new Hr(i,r.message||""));n=new Xi(a,c,h,l||null)}else if("documentChange"in e){e.documentChange;var p=e.documentChange;p.document,p.document.name,p.document.updateTime;var d=Bo(t,p.document.name),v=jo(p.document.updateTime),y=new Qs({mapValue:{fields:p.document.fields}}),g=new uu(d,v,y,{}),m=p.targetIds||[],w=p.removedTargetIds||[];n=new Hi(m,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;var b=e.documentDelete;b.document;var I=Bo(t,b.document),E=b.readTime?jo(b.readTime):Xr.min(),T=new au(I,E),N=b.removedTargetIds||[];n=new Hi([],N,T.key,T)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var _=Bo(t,A.document),S=A.removedTargetIds||[];n=new Hi([],S,_,null)}else{if(!("filter"in e))return Sr();e.filter;var D=e.filter;D.targetId;var x=D.count||0,k=new wi(x),O=D.targetId;n=new $i(O,k)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Xr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Xr.min():jo(e.readTime)}(t);return this.listener.nu(e,n)},ml.prototype.su=function(t){var e,n,r,i,o={};o.database=Ko(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=yi(i)?{documents:Yo(e,i)}:{query:Jo(e,i)}).targetId=n.targetId,0<n.resumeToken.H()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.J){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Sr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Ka(o)},ml.prototype.iu=function(t){var e={};e.database=Ko(this.serializer),e.removeTarget=t,this.Ka(e)},ml),al=(n(gl,tl=sl),Object.defineProperty(gl.prototype,"ou",{get:function(){return this.ru},enumerable:!1,configurable:!0}),gl.prototype.start=function(){this.ru=!1,this.lastStreamToken=void 0,tl.prototype.start.call(this)},gl.prototype.za=function(){this.ru&&this.hu([])},gl.prototype.Za=function(t){return this.xa.eu("Write",t)},gl.prototype.onMessage=function(t){if(Dr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.Po.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Dr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(Xr.min())&&(n=jo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new As(n,r)}(t,i)})):[]),n=jo(t.commitTime);return this.listener.au(n,e)}var r,i;return Dr(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.uu()},gl.prototype.cu=function(){var t={};t.database=Ko(this.serializer),this.Ka(t)},gl.prototype.hu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xo(e.serializer,t)})};this.Ka(n)},gl),cl=(n(yl,Zf=function(){}),yl.prototype._u=function(){if(this.lu)throw new Hr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},yl.prototype.start=function(t){this.xa=t},yl.prototype.fu=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.fu(e,n,t)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.ya(),t})},yl.prototype.du=function(e,n){var r=this;return this._u(),this.credentials.getToken().then(function(t){return r.xa.du(e,n,t)}).catch(function(t){throw t.code===Kr.UNAUTHENTICATED&&r.credentials.ya(),t})},yl),hl=(vl.prototype.Au=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Ru(),0<this.mutations.length)throw new Hr(Kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return g(this,void 0,void 0,function(){var i,e,n,o,r;return w(this,function(t){switch(t.label){case 0:return i=xr(s),e={database:Ko(i.serializer),documents:u.map(function(t){return Go(i.serializer,t)})},[4,i.du("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Dr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),r=jo(e.found.updateTime),i=new Qs({mapValue:{fields:e.found.fields}});return new uu(n,r,i,{})}(e,n):"missing"in n?function(t,e){Dr(!!e.missing),Dr(!!e.readTime);var n=Bo(t,e.missing),r=jo(e.readTime);return new au(n,r)}(e,n):Sr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Dr(!!e),r.push(e)}),r)]}})})}(this.wu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof au||t instanceof uu?n.Pu(t):Sr()}),e)]}})})},vl.prototype.set=function(t,e){this.write(e.la(t,this.Ue(t))),this.mu.add(t)},vl.prototype.update=function(t,e){try{this.write(e.la(t,this.gu(t)))}catch(t){this.Iu=t}this.mu.add(t)},vl.prototype.delete=function(t){this.write([new $s(t,this.Ue(t))]),this.mu.add(t)},vl.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Ru(),this.Iu)throw this.Iu;return e=this.Tu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ti(Yr.N(e));r.mutations.push(new Xs(n,r.Ue(n)))}),[4,function(r,i){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return e=xr(r),n={database:Ko(e.serializer),writes:i.map(function(t){return Xo(e.serializer,t)})},[4,e.fu("Commit",n)];case 1:return t.sent(),[2]}})})}(this.wu,this.mutations)];case 1:return t.sent(),this.Eu=!0,[2]}})})},vl.prototype.Pu=function(t){var e;if(t instanceof uu)e=t.version;else{if(!(t instanceof au))throw Sr();e=Xr.min()}var n=this.Tu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Hr(Kr.ABORTED,"Document version changed between two reads.")}else this.Tu.set(t.key.toString(),e)},vl.prototype.Ue=function(t){var e=this.Tu.get(t.toString());return!this.mu.has(t)&&e?_s.updateTime(e):_s.We()},vl.prototype.gu=function(t){var e=this.Tu.get(t.toString());if(this.mu.has(t)||!e)return _s.exists(!0);if(e.isEqual(Xr.min()))throw new Hr(Kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},vl.prototype.write=function(t){this.Ru(),this.mutations=this.mutations.concat(t)},vl.prototype.Ru=function(){},vl),fl=(dl.prototype.vu=function(){var t=this;0===this.yu&&(this.Su("Unknown"),this.pu=this.ao.bs("online_state_timeout",1e4,function(){return t.pu=null,t.Du("Backend didn't respond within 10 seconds."),t.Su("Offline"),Promise.resolve()}))},dl.prototype.Cu=function(t){"Online"===this.state?this.Su("Unknown"):(this.yu++,1<=this.yu&&(this.Fu(),this.Du("Connection failed 1 times. Most recent error: "+t.toString()),this.Su("Offline")))},dl.prototype.set=function(t){this.Fu(),this.yu=0,"Online"===t&&(this.bu=!1),this.Su(t)},dl.prototype.Su=function(t){t!==this.state&&(this.state=t,this.Vu(t))},dl.prototype.Du=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.bu?(Ar(e),this.bu=!1):Nr("OnlineStateTracker",e)},dl.prototype.Fu=function(){null!==this.pu&&(this.pu.cancel(),this.pu=null)},dl),ll=(pl.prototype.start=function(){return this.enableNetwork()},pl.prototype.enableNetwork=function(){return this.Mu.delete(0),this.Ju()},pl.prototype.Ju=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qu()?(this.Xu()?this.Zu():this.Uu.set("Unknown"),[4,this.tc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},pl.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Mu.add(0),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Offline"),[2]}})})},pl.prototype.ec=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.Gu.stop()];case 1:return t.sent(),[4,this.Wu.stop()];case 2:return t.sent(),0<this.Nu.length&&(Nr("RemoteStore","Stopping write stream with "+this.Nu.length+" pending writes"),this.Nu=[]),this.nc(),[2]}})})},pl.prototype._r=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","RemoteStore shutting down."),this.Mu.add(5),[4,this.ec()];case 1:return t.sent(),this.Ou._r(),this.Uu.set("Unknown"),[2]}})})},pl.prototype.listen=function(t){this.ku.has(t.targetId)||(this.ku.set(t.targetId,t),this.Xu()?this.Zu():this.Wu.Ba()&&this.sc(t))},pl.prototype.ic=function(t){this.ku.delete(t),this.Wu.Ba()&&this.rc(t),0===this.ku.size&&(this.Wu.Ba()?this.Wu.Qa():this.qu()&&this.Uu.set("Unknown"))},pl.prototype.Me=function(t){return this.ku.get(t)||null},pl.prototype.xe=function(t){return this.oc.xe(t)},pl.prototype.sc=function(t){this.xu.de(t.targetId),this.Wu.su(t)},pl.prototype.rc=function(t){this.xu.de(t),this.Wu.iu(t)},pl.prototype.Zu=function(){this.xu=new no(this),this.Wu.start(),this.Uu.vu()},pl.prototype.Xu=function(){return this.qu()&&!this.Wu.qa()&&0<this.ku.size},pl.prototype.qu=function(){return 0===this.Mu.size},pl.prototype.nc=function(){this.xu=null},pl.prototype.Qu=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.ku.forEach(function(t,e){n.sc(t)}),[2]})})},pl.prototype.ju=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.nc(),this.Xu()?(this.Uu.Cu(e),this.Zu()):this.Uu.set("Unknown"),[2]})})},pl.prototype.Ku=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Uu.set("Online"),!(i instanceof Xi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.hc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.ac(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Hi?this.xu.Pe(i):i instanceof $i?this.xu.De(i):this.xu.ye(i),o.isEqual(Xr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.$u.ai()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.uc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.ac(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},pl.prototype.ac=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Hc(n))throw n;return this.Mu.add(1),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Offline"),r=r||function(){return e.$u.ai()},this.ao.er(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Mu.delete(1),[4,this.Ju()];case 2:return t.sent(),[2]}})})}),[2]}})})},pl.prototype.cc=function(e){var n=this;return e().catch(function(t){return n.ac(t,e)})},pl.prototype.uc=function(r){var i=this,t=this.xu.$e(r);return t.Wt.forEach(function(t,e){if(0<t.resumeToken.H()){var n=i.ku.get(e);n&&i.ku.set(e,n.tt(t.resumeToken,r))}}),t.Qt.forEach(function(t){var e=i.ku.get(t);if(e){i.ku.set(t,e.tt(gi.Y,e.X)),i.rc(t);var n=new Ei(e.target,t,1,e.sequenceNumber);i.sc(n)}}),this.oc.vh(t)},pl.prototype.hc=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.ku.has(i)?[4,this.oc.lc(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.ku.delete(i),this.xu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},pl.prototype.tc=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:e=0<this.Nu.length?this.Nu[this.Nu.length-1].batchId:-1,t.label=1;case 1:if(!this._c())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.$u.Fh(e)];case 3:return null===(n=t.sent())?(0===this.Nu.length&&this.Gu.Qa(),[3,7]):(e=n.batchId,this.fc(n),[3,6]);case 4:return r=t.sent(),[4,this.ac(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.dc()&&this.wc(),[2]}})})},pl.prototype._c=function(){return this.qu()&&this.Nu.length<10},pl.prototype.Tc=function(){return this.Nu.length},pl.prototype.fc=function(t){this.Nu.push(t),this.Gu.Ba()&&this.Gu.ou&&this.Gu.hu(t.mutations)},pl.prototype.dc=function(){return this.qu()&&!this.Gu.qa()&&0<this.Nu.length},pl.prototype.wc=function(){this.Gu.start()},pl.prototype.zu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.Gu.cu(),[2]})})},pl.prototype.Yu=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Nu;e<n.length;e++)r=n[e],this.Gu.hu(r.mutations);return[2]})})},pl.prototype.au=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Nu.shift(),n=ta.from(e,i,o),[4,this.cc(function(){return r.oc.Ec(n)})];case 1:return t.sent(),[4,this.tc()];case 2:return t.sent(),[2]}})})},pl.prototype.Hu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.Gu.ou?[4,this.Ic(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.dc()&&this.wc(),[2]}})})},pl.prototype.Ic=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==Kr.ABORTED?(e=this.Nu.shift(),this.Gu.Wa(),[4,this.cc(function(){return r.oc.mc(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.tc()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},pl.prototype.Ac=function(){return new hl(this.wu)},pl.prototype.Bu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Mu.add(4),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Unknown"),this.Gu.Wa(),this.Wu.Wa(),this.Mu.delete(4),[4,this.Ju()];case 2:return t.sent(),[2]}})})},pl.prototype.Rc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ao.$o(),Nr("RemoteStore","RemoteStore received new credentials"),this.Mu.add(3),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Unknown"),[4,this.oc.Rc(e)];case 2:return t.sent(),this.Mu.delete(3),[4,this.Ju()];case 3:return t.sent(),[2]}})})},pl.prototype.Pc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Mu.delete(2),[4,this.Ju()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Mu.add(2),[4,this.ec()]);case 3:t.sent(),this.Uu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},pl);function pl(t,e,n,r,i){var o,s,u,a,c,h,f,l,p=this;this.$u=t,this.wu=e,this.ao=n,this.Nu=[],this.ku=new Map,this.xu=null,this.Mu=new Set,this.Ou=i,this.Ou.Lu(function(t){n.Zi(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.qu()?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,this.Bu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Uu=new fl(n,r),this.Wu=(c=this.wu,h=n,f={tu:this.Qu.bind(this),Ha:this.ju.bind(this),nu:this.Ku.bind(this)},(l=xr(c))._u(),new ul(h,l.xa,l.credentials,l.serializer,f)),this.Gu=(o=this.wu,s=n,u={tu:this.zu.bind(this),Ha:this.Hu.bind(this),uu:this.Yu.bind(this),au:this.au.bind(this)},(a=xr(o))._u(),new al(s,a.xa,a.credentials,a.serializer,u))}function dl(t,e){this.ao=t,this.Vu=e,this.state="Unknown",this.yu=0,this.pu=null,this.bu=!0}function vl(t){this.wu=t,this.Tu=new Map,this.mutations=[],this.Eu=!1,this.Iu=null,this.mu=new Set}function yl(t,e){var n=this;return(n=Zf.call(this)||this).credentials=t,n.serializer=e,n.lu=!1,n}function gl(t,e,n,r,i){var o=this;return(o=tl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ru=!1,o}function ml(t,e,n,r,i){var o=this;return(o=el.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function wl(t,e,n,r,i,o){this.Ts=t,this.ka=n,this.xa=r,this.Ma=i,this.listener=o,this.state=0,this.Oa=0,this.La=null,this.stream=null,this.Po=new ga(t,e)}function bl(t,e){this.Fa=t,this.$a=e}function Il(t,e){this.Fa=t,this.$a=e,this.type="FirstParty",this.user=Qf.Pa}function El(t){var e=this;this.va=null,this.currentUser=Qf.UNAUTHENTICATED,this.Sa=!1,this.Da=0,this.Va=null,this.forceRefresh=!1,this.va=function(){e.Da++,e.currentUser=e.Ca(),e.Sa=!0,e.Va&&e.Va(e.currentUser)},this.Da=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.va):(this.va(null),t.get().then(function(t){e.auth=t,e.va&&e.auth.addAuthTokenListener(e.va)},function(){}))}function Tl(){this.Va=null}function Nl(t,e){return"firestore_clients_"+t+"_"+e}function Al(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function _l(t,e){return"firestore_targets_"+t+"_"+e}function Sl(t){this.key=t}function Dl(t){this.key=t}function xl(t,e,n){this.query=t,this.targetId=e,this.view=n}function kl(t){this.key=t,this.Ml=!1}var Ol=(Ql.gc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Hr(r.error.code,r.error.message)),i?new Ql(t,e,r.state,o):(Ar("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Ql.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Ql),Pl=(Xl.gc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Hr(n.error.code,n.error.message)),r?new Xl(t,n.state,i):(Ar("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Xl.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Xl),Ll=($l.gc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki(),o=0;r&&o<n.activeTargetIds.length;++o)r=fi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new $l(t,i):(Ar("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},$l),Rl=(Hl.gc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Hl(e.clientId,e.onlineState):(Ar("SharedClientState","Failed to parse online state: "+t),null)},Hl),Cl=(Kl.prototype.yc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Kl.prototype.pc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Kl.prototype.Vc=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Kl),Vl=(Wl.Oi=function(t){return!(!t||!t.localStorage)},Wl.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.oc.Ir()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.bc&&(o=this.getItem(Nl(this.persistenceKey,i)))&&(s=Ll.gc(i,o))&&(this.Dc=this.Dc.nt(s.clientId,s));for(this.Oc(),(u=this.storage.getItem(this.Mc))&&(a=this.Lc(u))&&this.qc(a),c=0,h=this.Cc;c<h.length;c++)f=h[c],this.Sc(f);return this.Cc=[],this.window.addEventListener("unload",function(){return l._r()}),this.Hi=!0,[2]}})})},Wl.prototype.ds=function(t){this.setItem(this.$c,JSON.stringify(t))},Wl.prototype.Bc=function(){return this.Uc(this.Dc)},Wl.prototype.Wc=function(n){var r=!1;return this.Dc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Wl.prototype.Qc=function(t){this.jc(t,"pending")},Wl.prototype.Kc=function(t,e,n){this.jc(t,e,n),this.Gc(t)},Wl.prototype.zc=function(t){var e="not-current";if(this.Wc(t)){var n=this.storage.getItem(_l(this.persistenceKey,t));if(n){var r=Pl.gc(t,n);r&&(e=r.state)}}return this.Hc.yc(t),this.Oc(),e},Wl.prototype.Yc=function(t){this.Hc.pc(t),this.Oc()},Wl.prototype.Jc=function(t){return this.Hc.activeTargetIds.has(t)},Wl.prototype.Xc=function(t){this.removeItem(_l(this.persistenceKey,t))},Wl.prototype.Zc=function(t,e,n){this.tl(t,e,n)},Wl.prototype.Ah=function(t,e,n){var r=this;e.forEach(function(t){r.Gc(t)}),this.currentUser=t,n.forEach(function(t){r.Qc(t)})},Wl.prototype.el=function(t){this.nl(t)},Wl.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.vc),this.removeItem(this.Fc),this.Hi=!1)},Wl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},Wl.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Wl.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Wl.prototype.Sc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Nr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Fc)return void Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Hi){if(null!==u.key)if(this.Nc.test(u.key)){if(null==u.newValue)return e=this.sl(u.key),[2,this.il(e,null)];if(n=this.rl(u.key,u.newValue))return[2,this.il(n.clientId,n)]}else if(this.kc.test(u.key)){if(null!==u.newValue&&(r=this.ol(u.key,u.newValue)))return[2,this.hl(r)]}else if(this.xc.test(u.key)){if(null!==u.newValue&&(i=this.al(u.key,u.newValue)))return[2,this.ul(i)]}else if(u.key===this.Mc){if(null!==u.newValue&&(o=this.Lc(u.newValue)))return[2,this.qc(o)]}else u.key===this.$c&&(s=function(t){var e=ua.ws;if(null!=t)try{var n=JSON.parse(t);Dr("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==ua.ws&&this.ls(s)}else this.Cc.push(u);return[2]})})})}},Object.defineProperty(Wl.prototype,"Hc",{get:function(){return this.Dc.get(this.bc)},enumerable:!1,configurable:!0}),Wl.prototype.Oc=function(){this.setItem(this.Fc,this.Hc.Vc())},Wl.prototype.jc=function(t,e,n){var r=new Ol(this.currentUser,t,e,n),i=Al(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Vc())},Wl.prototype.Gc=function(t){var e=Al(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Wl.prototype.nl=function(t){var e={clientId:this.bc,onlineState:t};this.storage.setItem(this.Mc,JSON.stringify(e))},Wl.prototype.tl=function(t,e,n){var r=_l(this.persistenceKey,t),i=new Pl(t,e,n);this.setItem(r,i.Vc())},Wl.prototype.sl=function(t){var e=this.Nc.exec(t);return e?e[1]:null},Wl.prototype.rl=function(t,e){var n=this.sl(t);return Ll.gc(n,e)},Wl.prototype.ol=function(t,e){var n=this.kc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ol.gc(new Qf(i),r,e)},Wl.prototype.al=function(t,e){var n=this.xc.exec(t),r=Number(n[1]);return Pl.gc(r,e)},Wl.prototype.Lc=function(t){return Rl.gc(t)},Wl.prototype.hl=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.oc.cl(e.batchId,e.state,e.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Wl.prototype.ul=function(t){return this.oc.ll(t.targetId,t.state,t.error)},Wl.prototype.il=function(t,e){var n=this,r=e?this.Dc.nt(t,e):this.Dc.remove(t),i=this.Uc(this.Dc),o=this.Uc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.oc._l(s,u).then(function(){n.Dc=r})},Wl.prototype.qc=function(t){this.Dc.get(t.clientId)&&this.Vu(t.onlineState)},Wl.prototype.Uc=function(t){var n=Ki();return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},Wl),Ul=(zl.prototype.Qc=function(t){},zl.prototype.Kc=function(t,e,n){},zl.prototype.zc=function(t){return this.fl.yc(t),this.dl[t]||"not-current"},zl.prototype.Zc=function(t,e,n){this.dl[t]=e},zl.prototype.Yc=function(t){this.fl.pc(t)},zl.prototype.Jc=function(t){return this.fl.activeTargetIds.has(t)},zl.prototype.Xc=function(t){delete this.dl[t]},zl.prototype.Bc=function(){return this.fl.activeTargetIds},zl.prototype.Wc=function(t){return this.fl.activeTargetIds.has(t)},zl.prototype.start=function(){return this.fl=new Cl,Promise.resolve()},zl.prototype.Ah=function(t,e,n){},zl.prototype.el=function(t){},zl.prototype._r=function(){},zl.prototype.ds=function(t){},zl),Ml=(Object.defineProperty(Bl.prototype,"Al",{get:function(){return this.wl},enumerable:!1,configurable:!0}),Bl.prototype.Rl=function(t,e){var u=this,a=e?e.Pl:new Yi,c=e?e.ml:this.ml,h=e?e.Lt:this.Lt,f=c,l=!1,p=this.query.hn()&&c.size===this.query.limit?c.last():null,d=this.query.an()&&c.size===this.query.limit?c.first():null;if(t.ot(function(t,e){var n=c.get(t),r=e instanceof uu?e:null;r=r&&(Su(u.query,r)?r:null);var i=!!n&&u.Lt.has(n.key),o=!!r&&(r.Ke||u.Lt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.gl(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.Il(r,p)||d&&u.Il(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),this.query.hn()||this.query.an())for(;f.size>this.query.limit;){var n=this.query.hn()?f.last():f.first();f=f.delete(n.key),h=h.delete(n.key),a.track({type:1,doc:n})}return{ml:f,Pl:a,Vl:l,Lt:h}},Bl.prototype.gl=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},Bl.prototype.qn=function(t,e,n){var o=this,r=this.ml;this.ml=t.ml,this.Lt=t.Lt;var i=t.Pl.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Il(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sr()}}var r,i}),this.yl(n);var s=e?this.pl():[],u=0===this.El.size&&this.Ht?1:0,a=u!==this.Tl;return this.Tl=u,0!==i.length||a?{snapshot:new Ji(this.query,t.ml,r,i,t.Lt,0==u,a,!1),bl:s}:{bl:s}},Bl.prototype.vl=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({ml:this.ml,Pl:new Yi,Lt:this.Lt,Vl:!1},!1)):{bl:[]}},Bl.prototype.Sl=function(t){return!this.wl.has(t)&&!!this.ml.has(t)&&!this.ml.get(t).Ke},Bl.prototype.yl=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.wl=e.wl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.wl=e.wl.delete(t)}),this.Ht=t.Ht)},Bl.prototype.pl=function(){var e=this;if(!this.Ht)return[];var n=this.El;this.El=zi(),this.ml.forEach(function(t){e.Sl(t.key)&&(e.El=e.El.add(t.key))});var r=[];return n.forEach(function(t){e.El.has(t)||r.push(new Dl(t))}),this.El.forEach(function(t){n.has(t)||r.push(new Sl(t))}),r},Bl.prototype.Dl=function(t){this.wl=t.Mh,this.El=zi();var e=this.Rl(t.documents);return this.qn(e,!0)},Bl.prototype.Cl=function(){return Ji.Ut(this.query,this.ml,this.Lt,0===this.Tl)},Bl),jl=(Gl.prototype.run=function(){this.$l()},Gl.prototype.$l=function(){var t=this;this.Po.ys(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new hl(this.wu),(n=this.Nl(e))&&n.then(function(t){r.ao.Zi(function(){return e.commit().then(function(){r.lo.resolve(t)}).catch(function(t){r.kl(t)})})}).catch(function(t){r.kl(t)}),[2]})})})},Gl.prototype.Nl=function(t){try{var e=this.updateFunction(t);return!ci(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},Gl.prototype.kl=function(t){var e=this;0<this.Fl&&this.xl(t)?(--this.Fl,this.ao.Zi(function(){return e.$l(),Promise.resolve()})):this.lo.reject(t)},Gl.prototype.xl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ni(e)},Gl),Fl=(Object.defineProperty(ql.prototype,"Xl",{get:function(){return!0===this.Jl},enumerable:!1,configurable:!0}),ql.prototype.subscribe=function(t){this.Bl=t},ql.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.Zl("listen()"),(r=this.Ul.get(s))?(e=r.targetId,this.Ll.zc(e),n=r.view.Cl(),[3,4]):[3,1];case 1:return[4,this.$u.Nh(bu(s))];case 2:return i=t.sent(),o=this.Ll.zc(i.targetId),e=i.targetId,[4,this.t_(s,e,"current"===o)];case 3:n=t.sent(),this.Xl&&this.Ol.listen(i),t.label=4;case 4:return[2,n]}})})},ql.prototype.t_=function(u,a,c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,this.$u.xh(u,!0)];case 1:return e=t.sent(),n=new Ml(u,e.Mh),r=n.Rl(e.documents),i=to.zt(a,c&&"Offline"!==this.onlineState),o=n.qn(r,this.Xl,i),this.e_(a,o.bl),s=new xl(u,a,n),[2,(this.Ul.set(u,s),this.Wl.has(a)?this.Wl.get(a).push(u):this.Wl.set(a,[u]),o.snapshot)]}})})},ql.prototype.ic=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.Zl("unlisten()"),e=this.Ul.get(i),1<(n=this.Wl.get(e.targetId)).length?[2,(this.Wl.set(e.targetId,n.filter(function(t){return!Nu(t,i)})),void this.Ul.delete(i))]:this.Xl?(this.Ll.Yc(e.targetId),this.Ll.Wc(e.targetId)?[3,2]:[4,this.$u.kh(e.targetId,!1).then(function(){r.Ll.Xc(e.targetId),r.Ol.ic(e.targetId),r.n_(e.targetId)}).catch(Ih)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.n_(e.targetId),[4,this.$u.kh(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},ql.prototype.write=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:this.Zl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.$u.Vh(i)];case 2:return e=t.sent(),this.Ll.Qc(e.batchId),this.s_(e.batchId,o),[4,this.i_(e.Cn)];case 3:return t.sent(),[4,this.Ol.tc()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=sh(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},ql.prototype.runTransaction=function(t,e,n){new jl(t,this.wu,e,n).run()},ql.prototype.vh=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.Zl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.$u.vh(n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Kl.get(e);n&&(Dr(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.Ml=!0:0<t.Jt.size?Dr(n.Ml):0<t.Xt.size&&(Dr(n.Ml),n.Ml=!1))}),[4,this.i_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Ih(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ql.prototype.vl=function(r,t){if(this.Xl&&0===t||!this.Xl&&1===t){this.Zl("applyOnlineStateChange()");var i=[];this.Ul.forEach(function(t,e){var n=e.view.vl(r);n.snapshot&&i.push(n.snapshot)}),this.Bl.r_(r),this.Bl.nu(i),this.onlineState=r,this.Xl&&this.Ll.el(r)}},ql.prototype.lc=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.Zl("rejectListens()"),this.Ll.Zc(u,"rejected",a),e=this.Kl.get(u),(n=e&&e.key)?(r=(r=new _i(ti.P)).nt(n,new au(n,Xr.min())),i=zi().add(n),o=new Zi(Xr.min(),new Map,new Li(Lr),r,i),[4,this.vh(o)]):[3,2];case 1:return t.sent(),this.jl=this.jl.remove(n),this.Kl.delete(u),this.o_(),[3,4];case 2:return[4,this.$u.kh(u,!1).then(function(){return s.n_(u,a)}).catch(Ih)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},ql.prototype.Ec=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.Zl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.$u.yh(r)];case 2:return n=t.sent(),this.h_(e,null),this.a_(e),this.Ll.Kc(e,"acknowledged"),[4,this.i_(n)];case 3:return t.sent(),[3,6];case 4:return[4,Ih(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ql.prototype.mc=function(n,r){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Zl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.$u.bh(n)];case 2:return e=t.sent(),this.h_(n,r),this.a_(n),this.Ll.Kc(n,"rejected",r),[4,this.i_(e)];case 3:return t.sent(),[3,6];case 4:return[4,Ih(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},ql.prototype.u_=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:this.Ol.qu()||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.$u.Wr()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Hl.get(e)||[]).push(o),this.Hl.set(e,n),[3,4]);case 3:return r=t.sent(),i=sh(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},ql.prototype.a_=function(t){(this.Hl.get(t)||[]).forEach(function(t){t.resolve()}),this.Hl.delete(t)},ql.prototype.c_=function(e){this.Hl.forEach(function(t){t.forEach(function(t){t.reject(new Hr(Kr.CANCELLED,e))})}),this.Hl.clear()},ql.prototype.s_=function(t,e){var n=this.zl[this.currentUser.Aa()];n=(n=n||new _i(Lr)).nt(t,e),this.zl[this.currentUser.Aa()]=n},ql.prototype.h_=function(t,e){var n=this.zl[this.currentUser.Aa()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.zl[this.currentUser.Aa()]=n}},ql.prototype.n_=function(t,e){var n=this;void 0===e&&(e=null),this.Ll.Yc(t);for(var r=0,i=this.Wl.get(t);r<i.length;r++){var o=i[r];this.Ul.delete(o),e&&this.Bl.l_(o,e)}this.Wl.delete(t),this.Xl&&this.Gl.jh(t).forEach(function(t){n.Gl.pi(t)||n.__(t)})},ql.prototype.__=function(t){var e=this.jl.get(t);null!==e&&(this.Ol.ic(e),this.jl=this.jl.remove(t),this.Kl.delete(e),this.o_())},ql.prototype.e_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Sl?(this.Gl.Ri(i.key,t),this.f_(i)):i instanceof Dl?(Nr("SyncEngine","Document no longer in limbo: "+i.key),this.Gl.gi(i.key,t),this.Gl.pi(i.key)||this.__(i.key)):Sr()}},ql.prototype.f_=function(t){var e=t.key;this.jl.get(e)||(Nr("SyncEngine","New document in limbo: "+e),this.Ql.push(e),this.o_())},ql.prototype.o_=function(){for(;0<this.Ql.length&&this.jl.size<this.ql;){var t=this.Ql.shift(),e=this.Yl.next();this.Kl.set(e,new kl(t)),this.jl=this.jl.nt(t,e),this.Ol.listen(new Ei(bu(gu(t.path)),e,2,ua.ws))}},ql.prototype.d_=function(){return this.jl},ql.prototype.w_=function(){return this.Ql},ql.prototype.i_=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Ul.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Rl(r);return n.Vl?u.$u.xh(i.query,!1).then(function(t){var e=t.documents;return i.view.Rl(e,n)}):n}).then(function(t){var e=a&&a.Wt.get(i.targetId),n=i.view.qn(t,u.Xl,e);if(u.e_(i.targetId,n.bl),n.snapshot){u.Xl&&u.Ll.Zc(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=sa.cs(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bl.nu(o),[4,this.$u.Ch(s)];case 2:return t.sent(),[2]}})})},ql.prototype.Zl=function(t){},ql.prototype.Rc=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Nr("SyncEngine","User change. New user:",n.Aa()),[4,this.$u.Ah(n)]);case 1:return e=t.sent(),this.currentUser=n,this.c_("'waitForPendingWrites' promise is rejected due to a user change."),this.Ll.Ah(n,e.Ph,e.gh),[4,this.i_(e.Rh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},ql.prototype.xe=function(t){var e=this.Kl.get(t);if(e&&e.Ml)return zi().add(e.key);var n=zi(),r=this.Wl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],u=this.Ul.get(s);n=n.Ct(u.view.Al)}return n},ql);function ql(t,e,n,r,i,o){this.$u=t,this.Ol=e,this.wu=n,this.Ll=r,this.currentUser=i,this.ql=o,this.Bl=null,this.Ul=new Wr(function(t){return Au(t)},Nu),this.Wl=new Map,this.Ql=[],this.jl=new _i(ti.P),this.Kl=new Map,this.Gl=new Eh,this.zl={},this.Hl=new Map,this.Yl=$a.si(),this.onlineState="Unknown",this.Jl=void 0}function Gl(t,e,n,r){this.ao=t,this.wu=e,this.updateFunction=n,this.lo=r,this.Fl=5,this.Po=new ga(this.ao,"transaction_retry")}function Bl(t,e){this.query=t,this.wl=e,this.Tl=null,this.Ht=!1,this.El=zi(),this.Lt=zi(),this.Il=Du(t),this.ml=new Qi(this.Il)}function zl(){this.fl=new Cl,this.dl={},this.Vu=null,this.ls=null}function Wl(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.bc=r,this.oc=null,this.Vu=null,this.ls=null,this.vc=this.Sc.bind(this),this.Dc=new _i(Lr),this.Hi=!1,this.Cc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Fc=Nl(this.persistenceKey,this.bc),this.$c="firestore_sequence_number_"+this.persistenceKey,this.Dc=this.Dc.nt(this.bc,new Cl),this.Nc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.kc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.xc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Mc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.vc)}function Kl(){this.activeTargetIds=Ki()}function Hl(t,e){this.clientId=t,this.onlineState=e}function $l(t,e){this.clientId=t,this.activeTargetIds=e}function Xl(t,e,n){this.targetId=t,this.state=e,this.error=n}function Ql(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Yl(t,e,n,r,i,o,s){var u=new Fl(t,e,n,r,i,o);return s&&(u.Jl=!0),u}function Jl(c,h,f,l){return g(this,void 0,void 0,function(){var u,a;return w(this,function(t){switch(t.label){case 0:return(u=xr(c)).Zl("applyBatchState()"),[4,(r=u.$u,i=h,o=xr(r),s=xr(o.jn),o.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return s.Br(e,i).next(function(t){return t?o.Ih.Jn(e,t):ea.resolve(null)})}))];case 1:return null===(a=t.sent())?[3,6]:"pending"!==f?[3,3]:[4,u.Ol.tc()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===f||"rejected"===f?(u.h_(h,l||null),e=u.$u,n=h,xr(xr(e).jn).Gr(n)):Sr(),t.label=4;case 4:return[4,u.i_(a)];case 5:return t.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+h),t.label=7;case 7:return[2]}var e,n,r,i,o,s})})}function Zl(h,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return r=xr(h),!0!==f||!0===r.Jl?[3,3]:(e=r.Ll.Bc(),[4,tp(r,e.F())]);case 1:return i=t.sent(),r.Jl=!0,[4,r.Ol.Pc(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Ol.listen(u);return[3,7];case 3:return!1!==f||!1===r.Jl?[3,7]:(a=[],c=Promise.resolve(),r.Wl.forEach(function(t,e){r.Ll.Jc(e)?a.push(e):c=c.then(function(){return r.n_(e),r.$u.kh(e,!0)}),r.Ol.ic(e)}),[4,c]);case 4:return t.sent(),[4,tp(r,a)];case 5:return t.sent(),(n=xr(r)).Kl.forEach(function(t,e){n.Ol.ic(e)}),n.Gl.Kh(),n.Kl=new Map,n.jl=new _i(ti.P),r.Jl=!1,[4,r.Ol.Pc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function tp(v,y){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=xr(v),n=[],r=[],i=0,o=y,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Wl.get(s))&&0!==a.length?[4,e.$u.Nh(bu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.Ul.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,(e=xr(i)).$u.xh(o.query,!0)];case 1:return n=t.sent(),r=o.view.Dl(n),[2,(e.Xl&&e.e_(o.targetId,r.bl),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,bh(e.$u,s)];case 8:return d=t.sent(),[4,e.$u.Nh(d)];case 9:return u=t.sent(),[4,e.t_(ep(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Bl.nu(r),n)]}})})}function ep(t){return yu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function np(s,u,a,c){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=xr(s)).Jl?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Wl.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=xr(n.$u),e=xr(r.Eh),r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ks(t,r.Th)}).then(function(t){var e=t.Gs,n=t.readTime;return r.Th=n,e}))];case 3:return i=t.sent(),o=Zi.Gt(u,"current"===a),[4,n.i_(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,n.$u.kh(u,!0)];case 6:return t.sent(),n.n_(u,c),[3,8];case 7:Sr(),t.label=8;case 8:return[2]}var r,e})})}function rp(){this.T_=void 0,this.listeners=[]}var ip,op=(dp.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.E_.get(e))||(n=!0,r=new rp),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.oc.listen(e)];case 2:return i.T_=t.sent(),[3,4];case 3:return o=t.sent(),s=sh(o,"Initialization of query '"+_u(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.E_.set(e,r),r.listeners.push(u),u.vl(this.onlineState),r.T_&&u.m_(r.T_)&&this.A_(),[2]}})})},dp.prototype.ic=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.E_.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.E_.delete(e),this.oc.ic(e))]:[2]})})},dp.prototype.nu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.E_.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].m_(i)&&(e=!0);s.T_=i}}e&&this.A_()},dp.prototype.l_=function(t,e){var n=this.E_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.E_.delete(t)},dp.prototype.r_=function(i){this.onlineState=i;var o=!1;this.E_.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].vl(i)&&(o=!0)}),o&&this.A_()},dp.prototype.R_=function(t){this.I_.add(t),t.next()},dp.prototype.P_=function(t){this.I_.delete(t)},dp.prototype.A_=function(){this.I_.forEach(function(t){t.next()})},dp),sp=(pp.prototype.m_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ji(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.V_?this.p_(t)&&(this.g_.next(t),o=!0):this.b_(t,this.onlineState)&&(this.v_(t),o=!0),this.y_=t,o},pp.prototype.onError=function(t){this.g_.error(t)},pp.prototype.vl=function(t){this.onlineState=t;var e=!1;return this.y_&&!this.V_&&this.b_(this.y_,t)&&(this.v_(this.y_),e=!0),e},pp.prototype.b_=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.S_&&n||t.docs._()&&"Offline"!==e)},pp.prototype.p_=function(t){if(0<t.docChanges.length)return!0;var e=this.y_&&this.y_.hasPendingWrites!==t.hasPendingWrites;return!(!t.qt&&!e)&&!0===this.options.includeMetadataChanges},pp.prototype.v_=function(t){t=Ji.Ut(t.query,t.docs,t.Lt,t.fromCache),this.V_=!0,this.g_.next(t)},pp),up=(lp.prototype.mh=function(t){this.D_=t},lp.prototype.ts=function(e,r,i,o){var s=this;return r.on()||i.isEqual(Xr.min())?this.C_(e,r):this.D_.Jn(e,o).next(function(t){var n=s.F_(r,t);return(r.hn()||r.an())&&s.Vl(r.en,n,o,i)?s.C_(e,r):(Tr()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_u(r)),s.D_.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},lp.prototype.F_=function(n,t){var r=new Li(Du(n));return t.forEach(function(t,e){e instanceof uu&&Su(n,e)&&(r=r.add(e))}),r},lp.prototype.Vl=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},lp.prototype.C_=function(t,e){return Tr()<=p.DEBUG&&Nr("IndexFreeQueryEngine","Using full collection scan to execute query:",_u(e)),this.D_.ts(t,e,Xr.min())},lp),ap=(fp.prototype.Or=function(t){return ea.resolve(0===this.jn.length)},fp.prototype.Lr=function(t,e,n,r){var i=this.N_;this.N_++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new Zu(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.k_=this.k_.add(new Th(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return ea.resolve(o)},fp.prototype.qr=function(t,e){return ea.resolve(this.x_(e))},fp.prototype.Ur=function(t,e){var n=e+1,r=this.M_(n),i=r<0?0:r;return ea.resolve(this.jn.length>i?this.jn[i]:null)},fp.prototype.Wr=function(){return ea.resolve(0===this.jn.length?-1:this.N_-1)},fp.prototype.Qr=function(t){return ea.resolve(this.jn.slice())},fp.prototype.zn=function(t,e){var n=this,r=new Th(e,0),i=new Th(e,Number.POSITIVE_INFINITY),o=[];return this.k_.vt([r,i],function(t){var e=n.x_(t.zh);o.push(e)}),ea.resolve(o)},fp.prototype.Zn=function(t,e){var r=this,i=new Li(Lr);return e.forEach(function(t){var e=new Th(t,0),n=new Th(t,Number.POSITIVE_INFINITY);r.k_.vt([e,n],function(t){i=i.add(t.zh)})}),ea.resolve(this.O_(i))},fp.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;ti.W(i)||(i=i.child(""));var o=new Th(new ti(i),0),s=new Li(Lr);return this.k_.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)},o),ea.resolve(this.O_(s))},fp.prototype.O_=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.x_(t);null!==e&&r.push(e)}),r},fp.prototype.Kr=function(n,r){var i=this;Dr(0===this.L_(r.batchId,"removed")),this.jn.shift();var o=this.k_;return ea.forEach(r.mutations,function(t){var e=new Th(t.key,r.batchId);return o=o.delete(e),i.ii.Dr(n,t.key)}).next(function(){i.k_=o})},fp.prototype.Gr=function(t){},fp.prototype.pi=function(t,e){var n=new Th(e,0),r=this.k_.Dt(n);return ea.resolve(e.isEqual(r&&r.key))},fp.prototype.zr=function(t){return this.jn.length,ea.resolve()},fp.prototype.L_=function(t,e){return this.M_(t)},fp.prototype.M_=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},fp.prototype.x_=function(t){var e=this.M_(t);return e<0||e>=this.jn.length?null:this.jn[e]},fp),cp=(hp.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.q_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},hp.prototype.xn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},hp.prototype.Mn=function(t,e){var n=this.docs.get(e);return ea.resolve(n?n.Ls:null)},hp.prototype.getEntries=function(t,e){var n=this,r=ji();return e.forEach(function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)}),ea.resolve(r)},hp.prototype.ts=function(t,e,n){for(var r=qi(),i=new ti(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,c=a.Ls,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof uu&&Su(e,c)&&(r=r.nt(c.key,c))}return ea.resolve(r)},hp.prototype.B_=function(t,e){return ea.forEach(this.docs,function(t){return e(t)})},hp.prototype.Hs=function(t){return new hp.Ys(this)},hp.prototype.Xs=function(t){return ea.resolve(this.size)},hp);function hp(t,e){this.Kn=t,this.q_=e,this.docs=new _i(ti.P),this.size=0}function fp(t,e){this.Kn=t,this.ii=e,this.jn=[],this.N_=1,this.k_=new Li(Th.Lh)}function lp(){}function pp(t,e,n){this.query=t,this.g_=e,this.V_=!1,this.y_=null,this.onlineState="Unknown",this.options=n||{}}function dp(t){this.oc=t,this.E_=new Wr(function(t){return Au(t)},Nu),this.onlineState="Unknown",this.I_=new Set,this.oc.subscribe(this)}function vp(t){var e=this;return(e=ip.call(this)||this).Zs=t,e}cp.Ys=(n(vp,ip=na),vp.prototype.qn=function(n){var r=this,i=[];return this.Cn.forEach(function(t,e){e?i.push(r.Zs.Nn(n,e,r.readTime)):r.Zs.xn(t)}),ea.Sn(i)},vp.prototype.On=function(t,e){return this.Zs.Mn(t,e)},vp.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},vp);var yp,gp,mp,wp=(Wp.prototype.pe=function(t,n){return this.U_.forEach(function(t,e){return n(e)}),ea.resolve()},Wp.prototype.ai=function(t){return ea.resolve(this.lastRemoteSnapshotVersion)},Wp.prototype.ui=function(t){return ea.resolve(this.W_)},Wp.prototype.ri=function(t){return this.highestTargetId=this.j_.next(),ea.resolve(this.highestTargetId)},Wp.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.W_&&(this.W_=e),ea.resolve()},Wp.prototype._i=function(t){this.U_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.j_=new $a(e),this.highestTargetId=e),t.sequenceNumber>this.W_&&(this.W_=t.sequenceNumber)},Wp.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,ea.resolve()},Wp.prototype.di=function(t,e){return this._i(e),ea.resolve()},Wp.prototype.wi=function(t,e){return this.U_.delete(e.target),this.Q_.jh(e.targetId),--this.targetCount,ea.resolve()},Wp.prototype.Ei=function(n,r,i){var o=this,s=0,u=[];return this.U_.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.U_.delete(t),u.push(o.Ti(n,e.targetId)),s++)}),ea.Sn(u).next(function(){return s})},Wp.prototype.Ii=function(t){return ea.resolve(this.targetCount)},Wp.prototype.mi=function(t,e){var n=this.U_.get(e)||null;return ea.resolve(n)},Wp.prototype.Ai=function(t,e,n){return this.Q_.Uh(e,n),ea.resolve()},Wp.prototype.Pi=function(e,t,n){this.Q_.Qh(t,n);var r=this.persistence.ii,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),ea.Sn(i)},Wp.prototype.Ti=function(t,e){return this.Q_.jh(e),ea.resolve()},Wp.prototype.Vi=function(t,e){var n=this.Q_.Gh(e);return ea.resolve(n)},Wp.prototype.pi=function(t,e){return ea.resolve(this.Q_.pi(e))},Wp),bp=(zp.prototype.start=function(){return Promise.resolve()},zp.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(zp.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),zp.prototype.Yi=function(){},zp.prototype.Xi=function(){},zp.prototype.gr=function(){return this.Kn},zp.prototype.mr=function(t){var e=this.K_[t.Aa()];return e||(e=new ap(this.Kn,this.ii),this.K_[t.Aa()]=e),e},zp.prototype.Rr=function(){return this.qi},zp.prototype.Pr=function(){return this.Qn},zp.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new Ip(this.Ci.next());return this.ii.z_(),n(i).next(function(t){return r.ii.H_(i).next(function(){return t})}).bn().then(function(t){return i.Wn(),t})},zp.prototype.Y_=function(e,n){return ea.Dn(Object.values(this.K_).map(function(t){return function(){return t.pi(e,n)}}))},zp),Ip=(n(Bp,mp=ia),Bp),Ep=(Gp.Z_=function(t){return new Gp(t)},Object.defineProperty(Gp.prototype,"tf",{get:function(){if(this.X_)return this.X_;throw Sr()},enumerable:!1,configurable:!0}),Gp.prototype.Ri=function(t,e,n){return this.J_.Ri(n,e),this.tf.delete(n),ea.resolve()},Gp.prototype.gi=function(t,e,n){return this.J_.gi(n,e),this.tf.add(n),ea.resolve()},Gp.prototype.Dr=function(t,e){return this.tf.add(e),ea.resolve()},Gp.prototype.removeTarget=function(t,e){var n=this;this.J_.jh(e.targetId).forEach(function(t){return n.tf.add(t)});var r=this.persistence.Rr();return r.Vi(t,e.targetId).next(function(t){t.forEach(function(t){return n.tf.add(t)})}).next(function(){return r.wi(t,e)})},Gp.prototype.z_=function(){this.X_=new Set},Gp.prototype.H_=function(t){var n=this,r=this.persistence.Pr().Hs();return ea.forEach(this.tf,function(e){return n.ef(t,e).next(function(t){t||r.xn(e)})}).next(function(){return n.X_=null,r.apply(t)})},Gp.prototype.Nr=function(t,e){var n=this;return this.ef(t,e).next(function(t){t?n.tf.delete(e):n.tf.add(e)})},Gp.prototype.G_=function(t){return 0},Gp.prototype.ef=function(t,e){var n=this;return ea.Dn([function(){return ea.resolve(n.J_.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.Y_(t,e)}])},Gp),Tp=(qp.prototype.tu=function(t){this.if=t},qp.prototype.Ha=function(t){this.rf=t},qp.prototype.onMessage=function(t){this.hf=t},qp.prototype.close=function(){this.sf()},qp.prototype.send=function(t){this.nf(t)},qp.prototype.af=function(){this.if()},qp.prototype.uf=function(t){this.rf(t)},qp.prototype.cf=function(t){this.hf(t)},qp),Np={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ap=(Fp.prototype._f=function(t,e){if(e)for(var n in e.ga)e.ga.hasOwnProperty(n)&&(t[n]=e.ga[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.1"},Fp.prototype.fu=function(a,r,i){var c=this,h=this.ff(a);return new Promise(function(o,s){var u=new wr;u.listenOnce(gr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case yr.NO_ERROR:var t=u.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case yr.TIMEOUT:Nr("Connection",'RPC "'+a+'" timed out'),s(new Hr(Kr.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=u.getStatus();if(Nr("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(Kr).indexOf(i)?i:Kr.UNKNOWN);s(new Hr(r,n.message))}else s(new Hr(Kr.UNKNOWN,"Server responded with status "+u.getStatus()))}else Nr("Connection",'RPC "'+a+'" failed'),s(new Hr(Kr.UNAVAILABLE,"Connection failed."));break;default:Sr()}}finally{Nr("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Nr("Connection","XHR sending: ",h+" "+e);var n={"Content-Type":"text/plain"};c._f(n,i),u.send(h,"POST",e,n,15)})},Fp.prototype.du=function(t,e,n){return this.fu(t,e,n)},Fp.prototype.eu=function(t,e){var n,r,i=[this.lf,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this._f(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Nr("Connection","Creating WebChannel: "+u+" "+s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new Tp({nf:function(t){f?Nr("Connection","Not sending because WebChannel is closed:",t):(h||(Nr("Connection","Opening WebChannel transport."),c.open(),h=!0),Nr("Connection","WebChannel sending:",t),c.send(t))},sf:function(){return c.close()}});return a(mr.EventType.OPEN,function(){f||Nr("Connection","WebChannel transport opened.")}),a(mr.EventType.CLOSE,function(){f||(f=!0,Nr("Connection","WebChannel transport closed"),l.uf())}),a(mr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Er.logLevel<=p.WARN){var r=e.map(_r);Er.warn.apply(Er,d(["Firestore (7.17.1): Connection"],r))}}("Connection","WebChannel transport errored:",t),l.uf(new Hr(Kr.UNAVAILABLE,"The operation could not be completed")))}),a(mr.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];Dr(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Nr("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=bi[i];if(void 0!==t)return Ai(t)}(),s=r.message;void 0===o&&(o=Kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.uf(new Hr(o,s)),c.close()}else Nr("Connection","WebChannel received:",n),l.cf(n)}}),setTimeout(function(){l.af()},0),l},Fp.prototype.ff=function(t){var e=Np[t];return this.lf+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Fp),_p=(jp.prototype.Lu=function(t){this.If.push(t)},jp.prototype._r=function(){window.removeEventListener("online",this.df),window.removeEventListener("offline",this.Tf)},jp.prototype.mf=function(){window.addEventListener("online",this.df),window.addEventListener("offline",this.Tf)},jp.prototype.wf=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(0)},jp.prototype.Ef=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(1)},jp.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jp),Sp=(Mp.prototype.Lu=function(t){},Mp.prototype._r=function(){},Mp),Dp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",xp=(Up.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.Ll=this.Af(r),this.persistence=this.Rf(r),[4,this.persistence.start()];case 1:return t.sent(),this.Pf=this.gf(r),this.$u=this.Vf(r),this.wu=this.yf(r),[4,this.pf(r)];case 2:return e=t.sent(),this.wu.start(e),this.Ol=this.bf(r),this.oc=this.vf(r),this.Sf=this.Df(r),this.Ll.Vu=function(t){return n.oc.vl(t,1)},this.Ol.oc=this.oc,[4,this.Ll.start()];case 3:return t.sent(),[4,this.Ol.start()];case 4:return t.sent(),[4,this.Ol.Pc(this.oc.Xl)];case 5:return t.sent(),[2]}})})},Up.prototype.pf=function(t){return e=t.Cf,Promise.resolve(new Ap(e));var e},Up.prototype.Df=function(t){return new op(this.oc)},Up.prototype.gf=function(t){return null},Up.prototype.Vf=function(t){return wh(this.persistence,new up,t.Ff)},Up.prototype.Rf=function(t){if(t.Nf.$f)throw new Hr(Kr.FAILED_PRECONDITION,Dp);return new bp(Ep.Z_)},Up.prototype.yf=function(t){var e,n=_f(t.Cf.s);return e=t.credentials,new cl(e,n)},Up.prototype.bf=function(t){var e=this;return new ll(this.$u,this.wu,t.ao,function(t){return e.oc.vl(t,0)},new(_p.Oi()?_p:Sp))},Up.prototype.Af=function(t){return new Ul},Up.prototype.vf=function(t){return Yl(this.$u,this.Ol,this.wu,this.Ll,t.Ff,t.ql,!0)},Up.prototype.clearPersistence=function(t,e){throw new Hr(Kr.FAILED_PRECONDITION,Dp)},Up),kp=(n(Vp,gp=xp),Vp.prototype.Vf=function(t){return wh(this.persistence,new up,t.Ff)},Vp.prototype.gf=function(t){var e=this.persistence.ii.yr;return new ph(e,t.ao)},Vp.prototype.Rf=function(t){var e=lc(t.Cf.s,t.Cf.persistenceKey),n=_f(t.Cf.s);return new ic(t.Nf.synchronizeTabs,e,t.clientId,hh.Ho(t.Nf.cacheSizeBytes),t.ao,eh(),"undefined"!=typeof document?document:null,n,this.Ll,t.Nf.Di)},Vp.prototype.Af=function(t){return new Ul},Vp.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return qc.Oi()?(e=n+"main",[4,qc.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(lc(t,e))},n(Cp,yp=Vp),Cp.prototype.initialize=function(e){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return[4,yp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.zi(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Zl(this.oc,e)];case 1:return t.sent(),this.Pf&&(e&&!this.Pf.Hi?this.Pf.start(this.$u):e||this.Pf.stop()),[2]}})})})];case 2:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return e=xr(r),n=xr(e.Eh),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.zs(t)}).then(function(t){e.Th=t})]})})}(this.$u)];case 3:return t.sent(),[2]}})})},Cp.prototype.vf=function(t){var e=!t.Nf.$f||!t.Nf.synchronizeTabs,n=Yl(this.$u,this.Ol,this.wu,this.Ll,t.Ff,t.ql,e);return this.Ll instanceof Vl&&(this.Ll.oc={cl:Jl.bind(null,n),ll:np.bind(null,n),_l:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=xr(f)).Jl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Wl.has(i)?(Nr("SyncEngine","Adding an already active target "+i),[3,5]):[4,bh(n.$u,i)]):[3,6];case 2:return o=t.sent(),[4,n.$u.Nh(o)];case 3:return s=t.sent(),[4,n.t_(ep(o),s.targetId,!1)];case 4:t.sent(),n.Ol.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Wl.has(e)?[4,n.$u.kh(e,!1).then(function(){n.Ol.ic(e),n.n_(e)}).catch(Ih)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,n),Ir:function(t){var e=xr(t);return xr(xr(e.$u).persistence).Ir()}.bind(null,n)}),n},Cp.prototype.Af=function(t){if(t.Nf.$f&&t.Nf.synchronizeTabs){var e=eh();if(!Vl.Oi(e))throw new Hr(Kr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lc(t.Cf.s,t.Cf.persistenceKey);return new Vl(e,t.ao,n,t.clientId,t.Ff)}return new Ul},Cp),Op=(Rp.prototype.start=function(t,e,n){var r=this;this.kf(),this.Cf=t;var i=new ya,o=new ya,s=!1;return this.credentials.pa(function(t){if(!s)return s=!0,Nr("FirestoreClient","Initializing. user=",t.uid),r.xf(e,n,t,o).then(i.resolve,i.reject);r.ao.er(function(){return r.Ol.Rc(t)})}),this.ao.Zi(function(){return i.promise}),o.promise},Rp.prototype.enableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue(function(){return t.persistence.Xi(!0),t.Ol.enableNetwork()})},Rp.prototype.xf=function(r,i,o,s){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r.initialize({ao:this.ao,Cf:this.Cf,clientId:this.clientId,credentials:this.credentials,Ff:o,ql:100,Nf:i})];case 1:return t.sent(),this.persistence=r.persistence,this.Ll=r.Ll,this.$u=r.$u,this.Ol=r.Ol,this.oc=r.oc,this.Pf=r.Pf,this.Mf=r.Sf,this.persistence.Yi(function(){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,3];case 2:if(e=t.sent(),s.reject(e),!this.Of(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.xf(new xp,{$f:!1},o,s))];case 3:return[2]}})})},Rp.prototype.Of=function(t){return"FirebaseError"===t.name?t.code===Kr.FAILED_PRECONDITION||t.code===Kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Rp.prototype.kf=function(){if(this.ao.yo)throw new Hr(Kr.FAILED_PRECONDITION,"The client has already been terminated.")},Rp.prototype.disableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue(function(){return t.persistence.Xi(!1),t.Ol.disableNetwork()})},Rp.prototype.terminate=function(){var t=this;return this.ao.Do(function(){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Pf&&this.Pf.stop(),[4,this.Ol._r()];case 1:return t.sent(),[4,this.Ll._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.ba(),[2]}})})})},Rp.prototype.waitForPendingWrites=function(){var t=this;this.kf();var e=new ya;return this.ao.Zi(function(){return t.oc.u_(e)}),e.promise},Rp.prototype.listen=function(t,e,n){var r=this;this.kf();var i=new sp(t,e,n);return this.ao.Zi(function(){return r.Mf.listen(i)}),i},Rp.prototype.ic=function(t){var e=this;this.Lf||this.ao.Zi(function(){return e.Mf.ic(t)})},Rp.prototype.qf=function(o){return g(this,void 0,void 0,function(){var i,e=this;return w(this,function(t){switch(t.label){case 0:return this.kf(),i=new ya,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.$u.$h(o)];case 1:return(e=t.sent())instanceof uu?i.resolve(e):e instanceof au?i.resolve(null):i.reject(new Hr(Kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=sh(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Rp.prototype.Bf=function(a){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return this.kf(),u=new ya,[4,this.ao.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.$u.xh(a,!0)];case 1:return e=t.sent(),n=new Ml(a,e.Mh),r=n.Rl(e.documents),i=n.qn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=sh(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Rp.prototype.write=function(t){var e=this;this.kf();var n=new ya;return this.ao.Zi(function(){return e.oc.write(t,n)}),n.promise},Rp.prototype.s=function(){return this.Cf.s},Rp.prototype.R_=function(t){var e=this;this.kf(),this.ao.Zi(function(){return e.Mf.R_(t),Promise.resolve()})},Rp.prototype.P_=function(t){var e=this;this.Lf||this.ao.Zi(function(){return e.Mf.P_(t),Promise.resolve()})},Object.defineProperty(Rp.prototype,"Lf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),Rp.prototype.transaction=function(t){var e=this;this.kf();var n=new ya;return this.ao.Zi(function(){return e.oc.runTransaction(e.ao,t,n),Promise.resolve()}),n.promise},Rp),Pp=(Lp.prototype.next=function(t){this.Uf(this.observer.next,t)},Lp.prototype.error=function(t){this.Uf(this.observer.error,t)},Lp.prototype.Wf=function(){this.muted=!0},Lp.prototype.Uf=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Lp);function Lp(t){this.observer=t,this.muted=!1}function Rp(t,e){this.credentials=t,this.ao=e,this.clientId=Or.t()}function Cp(){return null!==yp&&yp.apply(this,arguments)||this}function Vp(){return null!==gp&&gp.apply(this,arguments)||this}function Up(){}function Mp(){}function jp(){var t=this;this.df=function(){return t.wf()},this.Tf=function(){return t.Ef()},this.If=[],this.mf()}function Fp(t){this.s=t.s;var e=t.ssl?"https":"http";this.lf=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function qp(t){this.nf=t.nf,this.sf=t.sf}function Gp(t){this.persistence=t,this.J_=new Eh,this.X_=null}function Bp(t){var e=this;return(e=mp.call(this)||this).vi=t,e}function zp(t){var e=this;this.K_={},this.Ci=new ua(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new wp(this),this.Kn=new Ta,this.Qn=new cp(this.Kn,function(t){return e.ii.G_(t)})}function Wp(t){this.persistence=t,this.U_=new Wr(function(t){return di(t)},vi),this.lastRemoteSnapshotVersion=Xr.min(),this.highestTargetId=0,this.W_=0,this.Q_=new Eh,this.targetCount=0,this.j_=$a.ni()}function Kp(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Hp=(Zp.prototype.Kf=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return To(t.integerValue||t.doubleValue);case 3:return this.Gf(t.timestampValue);case 4:return this.zf(t);case 5:return t.stringValue;case 6:return new Xh(No(t.bytesValue));case 7:return this.Hf(t.referenceValue);case 8:return this.Yf(t.geoPointValue);case 9:return this.Jf(t.arrayValue);case 10:return this.Xf(t.mapValue);default:throw Sr()}},Zp.prototype.Xf=function(t){var n=this,r={};return Fr(t.fields||{},function(t,e){r[t]=n.Kf(e)}),r},Zp.prototype.Yf=function(t){return new mf(To(t.latitude),To(t.longitude))},Zp.prototype.Jf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Kf(t)})},Zp.prototype.zf=function(t){switch(this.Qf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return lo(n)?t(n):n}(t);return null==e?null:this.Kf(e);case"estimate":return this.Gf(po(t));default:return null}},Zp.prototype.Gf=function(t){var e=Eo(t),n=new $r(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Zp.prototype.Hf=function(t){var e=Yr.N(t);Dr(rs(e));var n=new Ur(e.get(1),e.get(3)),r=new ti(e.V(5));return n.isEqual(this.s)||Ar("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.jf(r)},Zp),$p=hh.Xo,Xp=(Jp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Jp),Qp=(Object.defineProperty(Yp.prototype,"ud",{get:function(){return this.ld||(this.ld=new Cf(this.aa,this.ad.ignoreUndefinedProperties)),this.ld},enumerable:!1,configurable:!0}),Yp.prototype.settings=function(t){Sh("Firestore.settings",arguments,1),kh("Firestore.settings","object",1,t);var e=new Xp(t);if(this.nd&&!this.ad.isEqual(e))throw new Hr(Kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ad=e).credentials&&(this.od=function(t){if(!t)return new nl;switch(t.type){case"gapi":var e=t._d;return Dr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ol(e,t.$a||"0");case"provider":return t._d;default:throw new Hr(Kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Yp.prototype.enableNetwork=function(){return this.ed(),this.nd.enableNetwork()},Yp.prototype.disableNetwork=function(){return this.ed(),this.nd.disableNetwork()},Yp.prototype.enablePersistence=function(t){var e,n;if(this.nd)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Ar("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Hr(Kr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.fd(this.hd,{$f:!0,cacheSizeBytes:this.ad.cacheSizeBytes,synchronizeTabs:r,Di:i})},Yp.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.nd&&!this.nd.Lf)throw new Hr(Kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ya,[2,(this.td.po(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.aa,this.rd)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Yp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Yp.prototype,"dd",{get:function(){return this.ed(),this.nd.Lf},enumerable:!1,configurable:!0}),Yp.prototype.waitForPendingWrites=function(){return this.ed(),this.nd.waitForPendingWrites()},Yp.prototype.onSnapshotsInSync=function(t){if(this.ed(),Kp(t))return td(this.nd,t);kh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return td(this.nd,e)},Yp.prototype.ed=function(){return this.nd||this.fd(new xp,{$f:!1}),this.nd},Yp.prototype.wd=function(){return new Vr(this.aa,this.rd,this.ad.host,this.ad.ssl,this.ad.forceLongPolling)},Yp.prototype.fd=function(t,e){var n=this.wd();return this.nd=new Op(this.od,this.td),this.nd.start(n,t,e)},Yp.sd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Hr(Kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Hr(Kr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ur(n)},Object.defineProperty(Yp.prototype,"app",{get:function(){if(!this.Zf)throw new Hr(Kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zf},enumerable:!1,configurable:!0}),Yp.prototype.collection=function(t){return Sh("Firestore.collection",arguments,1),kh("Firestore.collection","non-empty string",1,t),this.ed(),new Ad(Yr.N(t),this,null)},Yp.prototype.doc=function(t){return Sh("Firestore.doc",arguments,1),kh("Firestore.doc","non-empty string",1,t),this.ed(),id.Td(Yr.N(t),this,null)},Yp.prototype.collectionGroup=function(t){if(Sh("Firestore.collectionGroup",arguments,1),kh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ed(),new bd((e=t,new du(Yr.k(),e)),this,null);var e},Yp.prototype.runTransaction=function(e){var n=this;return Sh("Firestore.runTransaction",arguments,1),kh("Firestore.runTransaction","function",1,e),this.ed().transaction(function(t){return e(new nd(n,t))})},Yp.prototype.batch=function(){return this.ed(),new rd(this)},Object.defineProperty(Yp,"logLevel",{get:function(){switch(Tr()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Yp.setLogLevel=function(t){Sh("Firestore.setLogLevel",arguments,1),Ch("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Er.setLogLevel(t)},Yp.prototype.Ed=function(){return this.ad.timestampsInSnapshots},Yp);function Yp(t,e,n){var r=this;if(void 0===n&&(n=new xp),this.Zf=null,this.td=new rh,this.INTERNAL={delete:function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ed(),[4,this.nd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Zf=i,this.aa=Yp.sd(i),this.rd=i.name,this.od=new rl(e)}else{var o=t;if(!o.projectId)throw new Hr(Kr.INVALID_ARGUMENT,"Must provide projectId");this.aa=new Ur(o.projectId,o.database),this.rd="[DEFAULT]",this.od=new nl}this.hd=n,this.ad=new Xp({})}function Jp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Hr(Kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ph("settings","non-empty string","host",t.host),this.host=t.host,Lh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Fh("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Lh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Lh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Lh("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Ar("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Ar("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Lh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=hh.th;else{if(t.cacheSizeBytes!==$p&&t.cacheSizeBytes<hh.Zo)throw new Hr(Kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hh.Zo);this.cacheSizeBytes=t.cacheSizeBytes}Lh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Zp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Qf=n,this.jf=r}function td(t,e){var n=new Pp({next:function(){e.next&&e.next()},error:function(t){throw Sr()}});return t.R_(n),function(){n.Wf(),t.P_(n)}}var ed,nd=(ud.prototype.get=function(t){var n=this;Sh("Transaction.get",arguments,1);var r=Od("Transaction.get",t,this.Id);return this.md.Au([r.ua]).then(function(t){if(!t||1!==t.length)return Sr();var e=t[0];if(e instanceof au)return new fd(n.Id,r.ua,null,!1,!1,r.ca);if(e instanceof uu)return new fd(n.Id,r.ua,e,!1,!1,r.ca);throw Sr()})},ud.prototype.set=function(t,e,n){xh("Transaction.set",arguments,2,3);var r=Od("Transaction.set",t,this.Id);n=Dd("Transaction.set",n);var i=Pd(r.ca,e,n),o=Mf(this.Id.ud,"Transaction.set",r.ua,i,null!==r.ca,n);return this.md.set(r.ua,o),this},ud.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Yh?(Dh("Transaction.update",arguments,3),r=Od("Transaction.update",t,this.Id),Ff(this.Id.ud,"Transaction.update",r.ua,e,n,o)):(Sh("Transaction.update",arguments,2),r=Od("Transaction.update",t,this.Id),jf(this.Id.ud,"Transaction.update",r.ua,e)),this.md.update(r.ua,i),this},ud.prototype.delete=function(t){Sh("Transaction.delete",arguments,1);var e=Od("Transaction.delete",t,this.Id);return this.md.delete(e.ua),this},ud),rd=(sd.prototype.set=function(t,e,n){xh("WriteBatch.set",arguments,2,3),this.Pd();var r=Od("WriteBatch.set",t,this.Id);n=Dd("WriteBatch.set",n);var i=Pd(r.ca,e,n),o=Mf(this.Id.ud,"WriteBatch.set",r.ua,i,null!==r.ca,n);return this.Ad=this.Ad.concat(o.la(r.ua,_s.We())),this},sd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pd(),i="string"==typeof e||e instanceof Yh?(Dh("WriteBatch.update",arguments,3),r=Od("WriteBatch.update",t,this.Id),Ff(this.Id.ud,"WriteBatch.update",r.ua,e,n,o)):(Sh("WriteBatch.update",arguments,2),r=Od("WriteBatch.update",t,this.Id),jf(this.Id.ud,"WriteBatch.update",r.ua,e)),this.Ad=this.Ad.concat(i.la(r.ua,_s.exists(!0))),this},sd.prototype.delete=function(t){Sh("WriteBatch.delete",arguments,1),this.Pd();var e=Od("WriteBatch.delete",t,this.Id);return this.Ad=this.Ad.concat(new $s(e.ua,_s.We())),this},sd.prototype.commit=function(){return this.Pd(),this.Rd=!0,0<this.Ad.length?this.Id.ed().write(this.Ad):Promise.resolve()},sd.prototype.Pd=function(){if(this.Rd)throw new Hr(Kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},sd),id=(n(od,ed=Df),od.Td=function(t,e,n){if(t.length%2!=0)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new od(new ti(t),e,n)},Object.defineProperty(od.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"parent",{get:function(){return new Ad(this.ua.path.p(),this.firestore,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"path",{get:function(){return this.ua.path.$()},enumerable:!1,configurable:!0}),od.prototype.collection=function(t){if(Sh("DocumentReference.collection",arguments,1),kh("DocumentReference.collection","non-empty string",1,t),!t)throw new Hr(Kr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Yr.N(t);return new Ad(this.ua.path.child(e),this.firestore,null)},od.prototype.isEqual=function(t){if(!(t instanceof od))throw qh("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ua.isEqual(t.ua)&&this.ca===t.ca},od.prototype.set=function(t,e){xh("DocumentReference.set",arguments,1,2),e=Dd("DocumentReference.set",e);var n=Pd(this.ca,t,e),r=Mf(this.firestore.ud,"DocumentReference.set",this.ua,n,null!==this.ca,e);return this.nd.write(r.la(this.ua,_s.We()))},od.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Yh?(Dh("DocumentReference.update",arguments,2),Ff(this.firestore.ud,"DocumentReference.update",this.ua,t,e,r)):(Sh("DocumentReference.update",arguments,1),jf(this.firestore.ud,"DocumentReference.update",this.ua,t)),this.nd.write(n.la(this.ua,_s.exists(!0)))},od.prototype.delete=function(){return Sh("DocumentReference.delete",arguments,0),this.nd.write([new $s(this.ua,_s.We())])},od.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];xh("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Kp(i[u])||(Fh("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Lh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(Kp(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else kh("DocumentReference.onSnapshot","function",u,i[u]),Oh("DocumentReference.onSnapshot","function",u+1,i[u+1]),Oh("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.gd(t))},error:i[u+1],complete:i[u+2]};return ad(this.nd,this.ua,a,h)},od.prototype.get=function(t){var e,n,r,i,o,s=this;return xh("DocumentReference.get",arguments,0,1),kd("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.ed().qf(this.ua).then(function(t){return new fd(s.firestore,s.ua,t,!0,t instanceof uu&&t.Ke,s.ca)}):(e=this.nd,n=this.ua,r=t,i=new ya,o=ad(e,n,{includeMetadataChanges:!0,S_:!0},{next:function(t){o();var e=t.docs.has(n);!e&&t.fromCache?i.reject(new Hr(Kr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?i.reject(new Hr(Kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),i.promise.then(function(t){return s.gd(t)}))},od.prototype.withConverter=function(t){return new od(this.ua,this.firestore,t)},od.prototype.gd=function(t){var e=t.docs.get(this.ua);return new fd(this.firestore,this.ua,e,t.fromCache,t.hasPendingWrites,this.ca)},od);function od(t,e,n){var r=this;return(r=ed.call(this,e.aa,t,n)||this).ua=t,r.firestore=e,r.ca=n,r.nd=r.firestore.ed(),r}function sd(t){this.Id=t,this.Ad=[],this.Rd=!1}function ud(t,e){this.Id=t,this.md=e}function ad(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Pp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(gu(e.path),o,n);return function(){o.Wf(),t.ic(s)}}var cd,hd=(vd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},vd),fd=(dd.prototype.data=function(t){var e=this;if(xh("DocumentSnapshot.data",arguments,0,1),t=xd("DocumentSnapshot.data",t),this.Vd){if(this.ca){var n=new ld(this.Id,this.ua,this.Vd,this.yd,this.pd,null);return this.ca.fromFirestore(n,t)}return new Hp(this.Id.aa,this.Id.Ed(),t.serverTimestamps||"none",function(t){return new id(t,e.Id,null)}).Kf(this.Vd.Ze())}},dd.prototype.get=function(t,e){var n=this;if(xh("DocumentSnapshot.get",arguments,1,2),e=xd("DocumentSnapshot.get",e),this.Vd){var r=this.Vd.data().field(Kf("DocumentSnapshot.get",t,this.ua));if(null!==r)return new Hp(this.Id.aa,this.Id.Ed(),e.serverTimestamps||"none",function(t){return new id(t,n.Id,n.ca)}).Kf(r)}},Object.defineProperty(dd.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"ref",{get:function(){return new id(this.ua,this.Id,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"exists",{get:function(){return null!==this.Vd},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"metadata",{get:function(){return new hd(this.pd,this.yd)},enumerable:!1,configurable:!0}),dd.prototype.isEqual=function(t){if(!(t instanceof dd))throw qh("isEqual","DocumentSnapshot",1,t);return this.Id===t.Id&&this.yd===t.yd&&this.ua.isEqual(t.ua)&&(null===this.Vd?null===t.Vd:this.Vd.isEqual(t.Vd))&&this.ca===t.ca},dd),ld=(n(pd,cd=fd),pd.prototype.data=function(t){return cd.prototype.data.call(this,t)},pd);function pd(){return null!==cd&&cd.apply(this,arguments)||this}function dd(t,e,n,r,i,o){this.Id=t,this.ua=e,this.Vd=n,this.yd=r,this.pd=i,this.ca=o}function vd(t,e){this.hasPendingWrites=t,this.fromCache=e}function yd(t,e,n){if("string"==typeof n){if(""===n)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!mu(e)&&-1!==n.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Yr.N(n));if(!ti.W(r))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ao(t,new ti(r))}if(n instanceof Df)return Ao(t,n.ua);throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Mh(n)+".")}function gd(t,e){if(!Array.isArray(t)||0===t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function md(t,e,n){if(!n.isEqual(e))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function wd(t){if(t.an()&&0===t.tn.length)throw new Hr(Kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bd=(Id.prototype.where=function(t,e,n){Sh("Query.where",arguments,3),jh("Query.where",3,n);var r,i,o,s=Ch("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),u=Kf("Query.where",t),a=function(t,e,n,r,i,o,s){var u;if(i.O()){if("array-contains"===o||"array-contains-any"===o)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){gd(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(yd(r,t,f))}u={arrayValue:{values:a}}}else u=yd(r,t,s)}else"in"!==o&&"array-contains-any"!==o||gd(s,o),u=qf(n,e,s,"in"===o);var l=ku.create(i,o,u);return function(t,e){if(e instanceof ku){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=0<=n.indexOf(e.op),o=0<=r.indexOf(e.op);if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&md(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw a===e.op?new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}}(t,l),l}(this.bd,"Query.where",this.firestore.ud,this.firestore.aa,u,s,n);return new Id((r=this.bd,i=a,o=r.filters.concat([i]),new du(r.path,r.collectionGroup,r.tn.slice(),o,r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},Id.prototype.orderBy=function(t,e){var n;if(xh("Query.orderBy",arguments,1,2),Oh("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Hr(Kr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o,s=Kf("Query.orderBy",t),u=function(t,e,n){if(null!==t.startAt)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Yu(e,n);return function(t,e){if(null===t.un()){var n=t.cn();null!==n&&md(0,n,e.field)}}(t,r),r}(this.bd,s,n);return new Id((r=this.bd,i=u,o=r.tn.concat([i]),new du(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.en,r.startAt,r.endAt)),this.firestore,this.ca)},Id.prototype.limit=function(t){return Sh("Query.limit",arguments,1),kh("Query.limit","number",1,t),Gh("Query.limit",1,t),new Id(Iu(this.bd,t,"F"),this.firestore,this.ca)},Id.prototype.limitToLast=function(t){return Sh("Query.limitToLast",arguments,1),kh("Query.limitToLast","number",1,t),Gh("Query.limitToLast",1,t),new Id(Iu(this.bd,t,"L"),this.firestore,this.ca)},Id.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.startAt",arguments,1);var r=this.vd("Query.startAt",t,e,!0);return new Id(Eu(this.bd,r),this.firestore,this.ca)},Id.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.startAfter",arguments,1);var r=this.vd("Query.startAfter",t,e,!1);return new Id(Eu(this.bd,r),this.firestore,this.ca)},Id.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.endBefore",arguments,1);var r=this.vd("Query.endBefore",t,e,!0);return new Id(Tu(this.bd,r),this.firestore,this.ca)},Id.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Dh("Query.endAt",arguments,1);var r=this.vd("Query.endAt",t,e,!1);return new Id(Tu(this.bd,r),this.firestore,this.ca)},Id.prototype.isEqual=function(t){if(!(t instanceof Id))throw qh("isEqual","Query",1,t);return this.firestore===t.firestore&&Nu(this.bd,t.bd)&&this.ca===t.ca},Id.prototype.withConverter=function(t){return new Id(this.bd,this.firestore,t)},Id.prototype.vd=function(t,e,n,r){if(jh(t,1,e),e instanceof fd)return Sh(t,d([e],n),1),function(t,e,n,r,i){if(!r)throw new Hr(Kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=wu(t);s<u.length;s++){var a=u[s];if(a.field.O())o.push(Ao(e,r.key));else{var c=r.field(a.field);if(lo(c))throw new Hr(Kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.$();throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Gu(o,i)}(this.bd,this.firestore.aa,t,e.Vd,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new Hr(Kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.O()){if("string"!=typeof c)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!mu(t)&&-1!==c.indexOf("/"))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Yr.N(c));if(!ti.W(h))throw new Hr(Kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new ti(h);u.push(Ao(e,f))}else{var l=qf(n,r,c);u.push(l)}}return new Gu(u,o)}(this.bd,this.firestore.aa,this.firestore.ud,t,i,r)},Id.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];xh("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||Kp(i[u])||(Fh("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Lh("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),Kp(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else kh("Query.onSnapshot","function",u,i[u]),Oh("Query.onSnapshot","function",u+1,i[u+1]),Oh("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new Nd(r.firestore,r.bd,t,r.ca))},error:i[u+1],complete:i[u+2]};return wd(this.bd),Ed(this.firestore.ed(),this.bd,s,c)},Id.prototype.get=function(t){var e=this;xh("Query.get",arguments,0,1),kd("Query.get",t),wd(this.bd);var n,r,i,o,s,u=this.firestore.ed();return(t&&"cache"===t.source?u.Bf(this.bd):(n=u,r=this.bd,i=t,o=new ya,s=Ed(n,r,{includeMetadataChanges:!0,S_:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Hr(Kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)).then(function(t){return new Nd(e.firestore,e.bd,t,e.ca)})},Id);function Id(t,e,n){this.bd=t,this.firestore=e,this.ca=n}function Ed(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Pp({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Wf(),t.ic(s)}}var Td,Nd=(Object.defineProperty(Sd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"empty",{get:function(){return this.Dd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"size",{get:function(){return this.Dd.docs.size},enumerable:!1,configurable:!0}),Sd.prototype.forEach=function(e,n){var r=this;xh("QuerySnapshot.forEach",arguments,1,2),kh("QuerySnapshot.forEach","function",1,e),this.Dd.docs.forEach(function(t){e.call(n,r.$d(t,r.metadata.fromCache,r.Dd.Lt.has(t.key)))})},Object.defineProperty(Sd.prototype,"query",{get:function(){return new bd(this.Sd,this.Id,this.ca)},enumerable:!1,configurable:!0}),Sd.prototype.docChanges=function(t){t&&(Fh("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Lh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Dd.Bt)throw new Hr(Kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Cd&&this.Fd===e||(this.Cd=function(i,e,o){if(i.Ot._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ot;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Lt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Sr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Dd,e,this.$d.bind(this)),this.Fd=e),this.Cd},Sd.prototype.isEqual=function(t){if(!(t instanceof Sd))throw qh("isEqual","QuerySnapshot",1,t);return this.Id===t.Id&&Nu(this.Sd,t.Sd)&&this.Dd.isEqual(t.Dd)&&this.ca===t.ca},Sd.prototype.$d=function(t,e,n){return new ld(this.Id,t.key,t,e,n,this.ca)},Sd),Ad=(n(_d,Td=bd),Object.defineProperty(_d.prototype,"id",{get:function(){return this.bd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"parent",{get:function(){var t=this.bd.path.p();return t._()?null:new id(new ti(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(_d.prototype,"path",{get:function(){return this.bd.path.$()},enumerable:!1,configurable:!0}),_d.prototype.doc=function(t){xh("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Or.t()),kh("CollectionReference.doc","non-empty string",1,t);var e=Yr.N(t);return id.Td(this.bd.path.child(e),this.firestore,this.ca)},_d.prototype.add=function(t){Sh("CollectionReference.add",arguments,1),kh("CollectionReference.add","object",1,this.ca?this.ca.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},_d.prototype.withConverter=function(t){return new _d(this.Nd,this.firestore,t)},_d);function _d(t,e,n){var r=this;if(((r=Td.call(this,gu(t),e,n)||this).Nd=t).length%2!=1)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.$()+" has "+t.length);return r}function Sd(t,e,n,r){this.Id=t,this.Sd=e,this.Dd=n,this.ca=r,this.Cd=null,this.Fd=null,this.metadata=new hd(n.hasPendingWrites,n.fromCache)}function Dd(t,e){if(void 0===e)return{merge:!1};if(Fh(t,e,["merge","mergeFields"]),Lh(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Mh(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Hr(Kr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Mh(n[i]))}(n,"mergeFields",r,function(t){return"string"==typeof t||t instanceof Yh}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Hr(Kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function xd(t,e){return void 0===e?{}:(Fh(t,e,["serverTimestamps"]),Rh(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function kd(t,e){Oh(t,"object",1,e),e&&(Fh(t,e,["source"]),Rh(t,0,"source",e.source,["default","server","cache"]))}function Od(t,e,n){if(e instanceof Df){if(e.firestore!==n)throw new Hr(Kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw qh(t,"DocumentReference",1,e)}function Pd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ld,Rd={Firestore:Qp,GeoPoint:mf,Timestamp:$r,Blob:Xh,Transaction:nd,WriteBatch:rd,DocumentReference:id,DocumentSnapshot:fd,Query:bd,QueryDocumentSnapshot:ld,QuerySnapshot:Nd,CollectionReference:Ad,FieldPath:Yh,FieldValue:yf,setLogLevel:Qp.setLogLevel,CACHE_SIZE_UNLIMITED:$p};(Ld=Cd).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Qp(e,n,new kp);var e,n},"PUBLIC").setServiceProps(Object.assign({},Rd))),Ld.registerVersion("@firebase/firestore","1.16.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
